<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Foodiefeed.BoardPage"
             Background="White"
             x:Name="Page"
             xmlns:local="clr-namespace:Foodiefeed;assembly=Foodiefeed"
             xmlns:viewmodel="clr-namespace:Foodiefeed.viewmodels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:views="clr-namespace:Foodiefeed.views.windows.contentview"
             xmlns:popup="clr-namespace:Foodiefeed.views.windows.popups"
             >
    <ContentPage.Resources>
        <local:AdjustPostSpace x:Key="AdjustPostSpace"/>
        <local:FollowOrNotFollowConverter x:Key="FollowOrNotFollowConverter"/>
        <x:Double x:Key="NoNotificationsHeightAdjustValue">100</x:Double>
        <x:Double x:Key="LeftBarHeightAdjustValue">170</x:Double>
        <x:Double x:Key="MidBarWidthAdjustValue">600</x:Double>
        <x:Double x:Key="MidBarHeightAdjustValue">100</x:Double>
        <x:Double x:Key="PostCollectionViewAdjustValue">160</x:Double>
        <x:Double x:Key="RightBarHeightAdjustValue">100</x:Double>
        <x:Double x:Key="BorderWidthValueAdjustment">-20</x:Double>
        <x:Double x:Key="PostWidthValueAdjustment">750</x:Double>
        <x:Double x:Key="RecipeCollectionViewHeightAdjustValue">235</x:Double>
        <local:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <local:Base64ToImageSourceConverter x:Key="Base64ToImageSourceConverter" />

        <DataTemplate x:Key="FriendRequestNotificationTemplate">
            <views:FriendRequestNotification Message="{Binding Message}" UserId="{Binding UserId}" ImageBase64="{Binding ImageBase64}"/>
        </DataTemplate>

        <DataTemplate x:Key="CommentLikeNotificationTemplate">
            <views:CommentLikeNotification Message="{Binding Message}" UserId="{Binding UserId}" CommentId="{Binding CommentId}" ImageBase64="{Binding ImageBase64}"/>
        </DataTemplate>

        <DataTemplate x:Key="PostLikeNotificationTemplate">
            <views:PostLikeNotification Message="{Binding Message}" UserId="{Binding UserId}" ImageBase64="{Binding ImageBase64}"/>
        </DataTemplate>

        <DataTemplate x:Key="PostCommentNotificationTemplate">
            <views:PostCommentNotification Message="{Binding Message}" UserId="{Binding UserId}" PostId="{Binding PostId}" CommentId="{Binding CommentId}" ImageBase64="{Binding ImageBase64}"/>
        </DataTemplate>

        <DataTemplate x:Key="BasicNotificationTemplate">
            <views:BasicNotofication Message="{Binding Message}" UserId="{Binding UserId}" ImageBase64="{Binding ImageBase64}"/>
        </DataTemplate>

        <local:NotificationTemplateSelector x:Key="NotificationTemplateSelector"
                                            FriendRequestNotificationTemplate="{StaticResource FriendRequestNotificationTemplate}"
                                            CommentLikeNotificationTemplate="{StaticResource CommentLikeNotificationTemplate}"
                                            PostLikeNotificationTemplate="{StaticResource PostLikeNotificationTemplate}"
                                            PostCommentNotificationTemplate="{StaticResource PostCommentNotificationTemplate}"
                                            BasicNotificationTemplate="{StaticResource BasicNotificationTemplate}"/>
    </ContentPage.Resources>
    
    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior Command="{Binding AppearingCommand}" EventName="Appearing" />
    </ContentPage.Behaviors>

    <Grid>
        <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" IsVisible="{OnPlatform WinUI=False}">
            <Grid.RowDefinitions>
                <RowDefinition Height="114"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid Grid.Row="0">
                <VerticalStackLayout>
                    <Grid>
                        <BoxView Color="{DynamicResource MainBackgroundColor}" 
                                 WidthRequest="{Binding Source={x:Reference Page},Path=Width}" 
                                 HeightRequest="70" 
                                 VerticalOptions="Start">

                        </BoxView>
                        <ImageButton Source="{DynamicResource LogoPath}" 
                                     HeightRequest="50" 
                                     WidthRequest="50" 
                                     VerticalOptions="Start" 
                                     HorizontalOptions="Start" 
                                     BackgroundColor="Transparent"
                                     Margin="0,10"/>
                        <Entry HeightRequest="0" WidthRequest="0"/>
                        <Border Margin="0,15" 
                                VerticalOptions="Start" 
                                Stroke="Gray" 
                                StrokeThickness="1.5" 
                                StrokeShape="RoundRectangle 20,20,20,20" 
                                HeightRequest="35"
                                WidthRequest="200"
                                BackgroundColor="{DynamicResource EntryBackround}">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}">
                                <Entry TextColor="{DynamicResource TextColor}" 
                                       FontSize="18" 
                                       Placeholder="Search" 
                                       Margin="0" 
                                       HeightRequest="40" 
                                       WidthRequest="180" 
                                       x:Name="Android_search_entry"
                                       Text="{Binding SearchParam,Mode=TwoWay}"
                                       BackgroundColor="Transparent">
                                    <Entry.Behaviors>
                                        <toolkit:EventToCommandBehavior EventName="Focused" Command="{Binding ShowSearchPanelCommand}"/>
                                        <toolkit:EventToCommandBehavior EventName="Unfocused" Command="{Binding HideSearchPanelCommand}"/>
                                        <toolkit:EventToCommandBehavior EventName="TextChanged" Command="{Binding SearchCommand}"/>
                                    </Entry.Behaviors>
                                </Entry>
                            </Grid>
                        </Border>

                        <Border Margin="0,5,5,0" HorizontalOptions="End" VerticalOptions="Start" StrokeShape="RoundRectangle 40" WidthRequest="54" 
                                HeightRequest="54" 
                                Stroke="{DynamicResource TextColor}" StrokeThickness="1">
                            <Image HeightRequest="50"
                                   WidthRequest="50"
                                   Source="{Binding ProfilePictureSource}" 
                                   Aspect="Fill"
                                   BackgroundColor="{DynamicResource MainBackgroundColorContrast}"/>
                        </Border>
                        <Grid.Shadow>
                            <Shadow Opacity="0.8"/>
                        </Grid.Shadow>
                    </Grid>
                    <Border StrokeShape="RoundRectangle 0,0,10,10" Stroke="Transparent" Margin="0" BackgroundColor="{DynamicResource MainBackgroundColorContrast}">
                        <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Always" BackgroundColor="{DynamicResource MainBackgroundColorContrast}">
                            <HorizontalStackLayout>
                                <Button Text="Posts" Command="{Binding ToMainViewCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="Profile" Command="{Binding ToProfileViewCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="Recipes" Command="{Binding ToRecipesViewCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="Settings" Command="{Binding ToSettingViewCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="Notifications" Command="{Binding ShowNotificationsCommand}" WidthRequest="110" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="Friends" Command="{Binding ShowOnlinefriendsCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                                <Button Text="LogOut" Command="{Binding LogoutCommand}" WidthRequest="100" Background="Transparent" TextColor="{DynamicResource TextColor}" FontAttributes="Bold"/>
                            </HorizontalStackLayout>
                        </ScrollView>
                    </Border>
                </VerticalStackLayout>
            </Grid>
            <Grid Grid.Row="1" BackgroundColor="{DynamicResource MainBackgroundColor}">
                <Grid x:Name="Main" IsVisible="{Binding PostPageVisible}">
                    <VerticalStackLayout>
                        <Frame BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                               HeightRequest="40" 
                               Margin="0,5,0,0" 
                               BorderColor="Transparent" 
                               HasShadow="True" Padding="5">
                                <Frame Padding="1" 
                                       BackgroundColor="{DynamicResource MainBackgroundColor}" HasShadow="True">
                                    <Label Text="+" TextColor="{DynamicResource TextColor}" 
                                           HorizontalOptions="Center" VerticalOptions="Center"/>
                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding ShowAddPostFormCommand}"/>
                                    </Frame.GestureRecognizers>
                                </Frame>
                        </Frame>
                        <CollectionView ItemsSource="{Binding Posts}"
                                        RemainingItemsThreshold="5"
                                        VerticalScrollBarVisibility="Always"
                                        ItemsUpdatingScrollMode="KeepScrollOffset"
                                        RemainingItemsThresholdReachedCommand="{Binding MainWallPostThresholdExceedCommand}"                                  
                                        HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource PostCollectionViewAdjustValue}}">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <views:PostView Username="{Binding Username}"
                                                    TimeStamp="{Binding TimeStamp}"
                                                    PostTextContent="{Binding PostTextContent}"
                                                    PostLikeCount="{Binding PostLikeCount}"
                                                    ImageSource="{Binding ImageSource}"
                                                    ImagesBase64="{Binding ImagesBase64}"
                                                    PfpImageBase64="{Binding PfpImageBase64}"
                                                    PostId="{Binding PostId}"
                                                    NewCommentContent="{Binding NewCommentContent}"
                                                    Payload="{Binding Payload}"
                                                    DeleteButtonVisible="{Binding DeleteButtonVisible}"
                                                    PostProducts="{Binding PostProducts}"
                                                    PostContentVisible="{Binding PostContentVisible}"
                                                    PostImagesVisible="{Binding PostImagesVisible}"
                                                    LikePostCommand="{Binding LikePostCommand}"
                                                    UnlikePostCommand="{Binding UnlikePostCommand}"
                                                    SaveRecipeCommand="{Binding SaveRecipeCommand}"
                                                    UnsaveRecipeCommand="{Binding UnsaveRecipeCommand}"
                                                    LikingCommand="{Binding LikingCommand}"
                                                    SavingCommand="{Binding SavingCommand}"
                                                    LikeText="{Binding LikeText}"
                                                    SavingText="{Binding SavingText}"
                                                    SaveIconPathFill="{Binding SaveIconPathFill}"
                                                    IsLiked="{Binding IsLiked}"
                                                    IsSaved="{Binding IsSaved}"
                                                    Comments="{Binding Comments}"/>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>



                    </VerticalStackLayout>
                    <Grid VerticalOptions="End" 
                          ZIndex="100"
                          HorizontalOptions="Center" BackgroundColor="Transparent" HeightRequest="50" WidthRequest="500"
                          IsVisible="{Binding WallPostLoadingActivityIndicatorVisible}">
                        <ActivityIndicator IsRunning="True"  Color="Gray"/>
                    </Grid>
                </Grid>
                <Grid x:Name="Profile" Padding="10" IsVisible="{Binding ProfilePageVisible}">
                    <VerticalStackLayout>
                        <Border ZIndex="1" 
                                VerticalOptions="Start" 
                                HeightRequest="200" 
                                BackgroundColor="{DynamicResource MainBackgroundColor}"
                                StrokeShape="RoundRectangle 40">
                            <Grid  Padding="15"  
                                   BackgroundColor="{DynamicResource MainBackgroundColor}" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Border Grid.Column="0"
                                        HeightRequest="100" 
                                        WidthRequest="100" 
                                        StrokeThickness="1" 
                                        Stroke="{DynamicResource TextColor}"
                                        BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                        StrokeShape="RoundRectangle 100">
                                    <Image Source="{Binding AvatarBase64}"
                                           Aspect="AspectFill"/>
                                </Border>

                                <VerticalStackLayout Padding="5" 
                                                     VerticalOptions="Center" 
                                                     BackgroundColor="Transparent" 
                                                     Grid.Column="1">

                                    <Label Text="{Binding ProfileUsername}" 
                                           TextColor="{DynamicResource TextColor}" 
                                           FontSize="15" 
                                           FontAttributes="Bold"/>

                                    <Label Text="{Binding ProfileFriends}" 
                                           TextColor="{DynamicResource TextColor}"
                                           FontSize="10" 
                                           Margin="4,0,0,0"/>

                                    <Label Text="{Binding ProfileFollowers}" 
                                           TextColor="{DynamicResource TextColor}" 
                                           FontSize="10" 
                                           Margin="4,0,0,0"/>
                                </VerticalStackLayout>

                                <VerticalStackLayout IsVisible="{Binding ProfileAddFriendAndFollowButtonsVisible}"
                                                      BackgroundColor="Transparent"
                                                      Scale="0.8"
                                                      HorizontalOptions="End" 
                                                      VerticalOptions="Center"
                                                      Padding="10" 
                                                      Grid.Column="2" Spacing="5">
                                    <Button FontAttributes="Bold" 
                                            Text="Send friend request"
                                            FontSize="10"
                                            Padding="4"
                                            TextColor="Black"
                                            BackgroundColor="#e0e0e0" 
                                            Margin="0,0,0,0">
                                        <Button.Shadow>
                                            <Shadow Opacity="0.4"
                                                    Radius="10"/>
                                        </Button.Shadow>
                                        <Button.GestureRecognizers>
                                            <PointerGestureRecognizer PointerEntered="ScaleButtonSizeAnimation" 
                                                                      PointerExited="CondenseButtonSizeAnimation"/>
                                        </Button.GestureRecognizers>
                                    </Button>

                                    <Button FontAttributes="Bold" 
                                            Text="Follow" 
                                            BackgroundColor="#e32441" 
                                            Margin="0,0,0,0"
                                            FontSize="15"
                                            Padding="4">
                                        <Button.Shadow>
                                            <Shadow Opacity="0.4"
                                                    Radius="10"/>
                                        </Button.Shadow>
                                        <Button.GestureRecognizers>
                                            <PointerGestureRecognizer PointerEntered="ScaleButtonSizeAnimation" 
                                                   PointerExited="CondenseButtonSizeAnimation"/>
                                        </Button.GestureRecognizers>
                                    </Button>

                                </VerticalStackLayout>
                            </Grid>
                            <Border.Shadow>
                                <Shadow Opacity="0.5"
                                        Radius="10"/>
                            </Border.Shadow>

                        </Border>

                        <Border Margin="0,-40,0,0" 
                                ZIndex="0" 
                                BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                MaximumWidthRequest="1000" 
                                VerticalOptions="Start" 
                                HeightRequest="125"  
                                StrokeShape="RoundRectangle 0,0,40,40">
                            <Grid Padding="15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>

                                <Grid Padding="5" 
                                      VerticalOptions="End"  
                                      Grid.Column="0">
                                    <Button Command="{Binding ShowProfilePostsCommand}" 
                                            Text="Post" 
                                            HeightRequest="40" 
                                            FontAttributes="Bold" 
                                            FontSize="17"
                                            TextColor="{DynamicResource TextColor}"
                                            BackgroundColor="{Binding SelfPostButtonColor}">
                                        <Button.Shadow>
                                            <Shadow Opacity="0.4" 
                                                    Radius="5"/>
                                        </Button.Shadow>
                                    </Button>
                                </Grid>

                                <Grid Padding="5" 
                                      VerticalOptions="End" 
                                      Grid.Column="1" >
                                    <Button Command="{Binding ShowProfileFriendsCommand}" 
                                            Text="Friends" 
                                            HeightRequest="40" 
                                            FontAttributes="Bold" 
                                            FontSize="17"
                                            TextColor="{DynamicResource TextColor}"
                                            BackgroundColor="{Binding FriendsButtonColor}">
                                        <Button.Shadow>
                                            <Shadow Opacity="0.4" 
                                                    Radius="5"/>
                                        </Button.Shadow>
                                    </Button>
                                </Grid>

                                <Grid Padding="5" VerticalOptions="End" Grid.Column="2" >
                                    <Button Command="{Binding ShowProfileFollowersCommand}" 
                                            Text="Followers" 
                                            HeightRequest="40" 
                                            FontAttributes="Bold" 
                                            FontSize="17" 
                                            TextColor="{DynamicResource TextColor}"
                                            BackgroundColor="{Binding FollowersButtonColor}">
                                        <Button.Shadow>
                                            <Shadow Opacity="0.4" 
                                                    Radius="5"/>
                                        </Button.Shadow>
                                    </Button>
                                </Grid>

                            </Grid>
                            <Border.Shadow>
                                <Shadow Opacity="0.4" 
                                        Brush="Black"/>
                            </Border.Shadow>
                        </Border>

                        <VerticalStackLayout x:Name="ProfileSection_Android">

                            <Border IsVisible="{Binding ProfileFriendsVisible}" 
                                    x:Name="FriendsUniformGridBorder_Android"
                                    Margin="0,50,0,0" 
                                    BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                    StrokeShape="RoundRectangle 40,40,40,40" 
                                    MaximumWidthRequest="1200">
                                <ScrollView HeightRequest="300">
                                    <Grid>
                                        <toolkit:UniformItemsLayout MaxColumns="3"
                                                                    BackgroundColor="Transparent" 
                                                                    Padding="20" 
                                                                    BindableLayout.ItemsSource="{Binding ProfileFriendsList}" 
                                                                    x:Name="FriendsUniformGrid_Android">
                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate>
                                                    <views:OnListFriendView Username="{Binding Username}"
                                                                             AvatarImageSource="{Binding AvatarImageSource}"
                                                                             UserId="{Binding UserId}"
                                                                             Margin="0,5"/>
                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </toolkit:UniformItemsLayout>
                                        <Grid IsVisible="{Binding NoProfileFriendsVisible}" HorizontalOptions="Center" VerticalOptions="Center">
                                            <Label Text="This user has no friends." TextColor="{DynamicResource TextColor}" FontSize="20"/>
                                        </Grid>
                                    </Grid>
                                </ScrollView>

                                <Border.Shadow>
                                    <Shadow Opacity="0.4" Brush="Black"/>
                                </Border.Shadow>
                            </Border>



                            <Grid IsVisible="{Binding ProfilePostsVisible}" >
                                <CollectionView ItemsSource="{Binding ProfilePosts}"
                                                x:Name="ProfilePostsCollection_Android"
                                                RemainingItemsThreshold="2"
                                                RemainingItemsThresholdReachedCommand="{Binding ProfilePostThresholdReachedCommand}"
                                                BackgroundColor="Transparent" 
                                                HeightRequest="369"
                                                >
                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <views:PostView Username="{Binding Username}"
                                                            TimeStamp="{Binding TimeStamp}"
                                                            PostTextContent="{Binding PostTextContent}"
                                                            PostLikeCount="{Binding PostLikeCount}"
                                                            ImageSource="{Binding ImageSource}"
                                                            ImagesBase64="{Binding ImagesBase64}"
                                                            PfpImageBase64="{Binding PfpImageBase64}"
                                                            PostId="{Binding PostId}"
                                                            NewCommentContent="{Binding NewCommentContent}"
                                                            Payload="{Binding Payload}"
                                                            DeleteButtonVisible="{Binding DeleteButtonVisible}"
                                                            PostProducts="{Binding PostProducts}"
                                                            PostContentVisible="{Binding PostContentVisible}"
                                                            PostImagesVisible="{Binding PostImagesVisible}"
                                                            LikePostCommand="{Binding LikePostCommand}"
                                                            UnlikePostCommand="{Binding UnlikePostCommand}"
                                                            SaveRecipeCommand="{Binding SaveRecipeCommand}"
                                                            UnsaveRecipeCommand="{Binding UnsaveRecipeCommand}"
                                                            LikingCommand="{Binding LikingCommand}"
                                                            SavingCommand="{Binding SavingCommand}"
                                                            LikeText="{Binding LikeText}"
                                                            SavingText="{Binding SavingText}"
                                                            SaveIconPathFill="{Binding SaveIconPathFill}"
                                                            IsLiked="{Binding IsLiked}"
                                                            IsSaved="{Binding IsSaved}"
                                                            Comments="{Binding Comments}"/>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>
                                </CollectionView>
                                <Label Text="This user has no posts yet." Margin="0,200,0,0"
                                       FontSize="25" 
                                       TextColor="{DynamicResource TextColor}"
                                       IsVisible="{Binding NoPostOnProfile}" VerticalOptions="Center" HorizontalOptions="Center"/>
                            </Grid>

                            <Border  IsVisible="{Binding ProfileFollowersVisible}"
                                    Margin="0,50,0,0" 
                                    BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                    StrokeShape="RoundRectangle 40,40,40,40">
                                <ScrollView HeightRequest="300">
                                    <Grid>
                                        <toolkit:UniformItemsLayout MaxColumns="3" 
                                             BackgroundColor="Transparent" 
                                             Padding="20" 
                                             BindableLayout.ItemsSource="{Binding ProfileFollowersList}">
                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate>
                                                    <views:OnListFriendView Username="{Binding Username}"
                                                     AvatarImageSource="{Binding AvatarImageSource}"
                                                     UserId="{Binding UserId}"
                                                     Margin="0,5"/>
                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </toolkit:UniformItemsLayout>
                                        <Grid IsVisible="{Binding NoProfileFollowersVisible}" HorizontalOptions="Center" VerticalOptions="Center">
                                            <Label Text="This user has no followers." TextColor="{DynamicResource TextColor}" FontSize="20"/>
                                        </Grid>
                                    </Grid>
                                </ScrollView>
                                <Border.Shadow>
                                    <Shadow Opacity="0.4" Brush="Black"/>
                                </Border.Shadow>
                            </Border>


                            <Grid VerticalOptions="Center" HorizontalOptions="Center">
                                <VerticalStackLayout Margin="0,100,0,0">
                                    <Label TextColor="{DynamicResource TextColor}" 
                                           Text="Loading..." 
                                           IsVisible="{Binding LoadingLabelVisible}"/>
                                    <ActivityIndicator IsRunning="True" IsVisible="{Binding LoadingLabelVisible}" Color="{DynamicResource TextColor}"/>
                                </VerticalStackLayout>
                            </Grid>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Grid>
                <Grid x:Name="Recipes" IsVisible="{Binding RecipePageVisible}"   
                      BackgroundColor="{DynamicResource MainBackgroundColor}"
                      Padding="10,5,30,30">
                    <Grid.RowDefinitions>
                            <RowDefinition Height="100"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Frame BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
       HeightRequest="50" WidthRequest="230"
       BorderColor="Transparent"
       Grid.Row="0"
       Margin="0,-10,0,0" Padding="5" CornerRadius="30">

                            <Grid ColumnSpacing="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Button Text="Liked" 
                Grid.Column="0" 
                TextColor="{DynamicResource TextColor}" 
                MinimumHeightRequest="0" 
                MinimumWidthRequest="0" 
                HeightRequest="25" 
                WidthRequest="90"
                FontSize="15" 
                Padding="0"
                BackgroundColor="{Binding LikedRecipesButtonBackround}"
                Command="{Binding ShowLikedRecipesCommand}"/>
                                <Button Text="Saved" 
                Grid.Column="1" 
                TextColor="{DynamicResource TextColor}" 
                MinimumHeightRequest="0" 
                MinimumWidthRequest="0" 
                HeightRequest="25" 
                WidthRequest="90"
                FontSize="15" 
                Padding="0"
                BackgroundColor="{Binding SavedRecipesButtonBackround}"
                Command="{Binding ShowSavedRecipesCommand}"/>
                            </Grid>
                        </Frame>
                        <Grid Grid.Row="1"  IsVisible="{Binding LikedRecipesVisible}">
                            <CollectionView Grid.Row="1"
                                            ItemsSource="{Binding LikedRecipes}" IsVisible="{Binding NoLikedRecipes,Converter={StaticResource InverseBooleanConverter}}"
                                            RemainingItemsThreshold="5"
                                            ItemsUpdatingScrollMode="KeepScrollOffset"
                                            RemainingItemsThresholdReachedCommand="{Binding RecipesItemsThresholdExceedCommand}" 
                                            RemainingItemsThresholdReachedCommandParameter="{x:Static viewmodel:RecipeType.Liked}"
                                            WidthRequest="{Binding Source={x:Reference RecipeGrid},Path=Width}"
                                            HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource RecipeCollectionViewHeightAdjustValue}}">
                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                </CollectionView.ItemsLayout>
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="5,0,5,0">
                                            <views:RecipeView Id="{Binding Id}"
                                      Username="{Binding Username}"
                                      Image="{Binding Image}"
                                      RecipeContent="{Binding RecipeContent}"
                                      Products="{Binding Products}"
                                      ContentVisible="{Binding ContentVisible}"
                                      DeleteCommand="{Binding DeleteCommand}"/>
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        <Label Text="You have no liked recipes." TextColor="#afafaf" HorizontalOptions="Center" VerticalOptions="Center" FontSize="15" IsVisible="{Binding NoLikedRecipes}"/>
                    </Grid>
                        <Grid Grid.Row="1"  IsVisible="{Binding SavedRecipesVisible}">
                            <CollectionView Grid.Row="1"
                                            ItemsSource="{Binding SavedRecipes}" IsVisible="{Binding NoSavedRecipes,Converter={StaticResource InverseBooleanConverter}}"
                                            RemainingItemsThreshold="5"
                                            RemainingItemsThresholdReachedCommand="{Binding RecipesItemsThresholdExceedCommand}"
                                            RemainingItemsThresholdReachedCommandParameter="{x:Static viewmodel:RecipeType.Saved}"
                                            ItemsUpdatingScrollMode="KeepScrollOffset"
                                            WidthRequest="{Binding Source={x:Reference RecipeGrid},Path=Width}"
                                            Scrolled="CollectionView_Scrolled"
                                            HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource RecipeCollectionViewHeightAdjustValue}}">
                                <CollectionView.ItemsLayout>
                                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                </CollectionView.ItemsLayout>
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="5,0,5,0">
                                            <views:RecipeView Id="{Binding Id}"
                                      Username="{Binding Username}"
                                      Image="{Binding Image}"
                                      RecipeContent="{Binding RecipeContent}"
                                      Products="{Binding Products}"
                                      ContentVisible="{Binding ContentVisible}"
                                      DeleteCommand="{Binding DeleteCommand}"/>
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                            <Label Text="You have no saved recipes." TextColor="#afafaf" HorizontalOptions="Center" VerticalOptions="Center" FontSize="15" IsVisible="{Binding NoSavedRecipes}"/>
                    </Grid>
                </Grid>
                <Grid x:Name="Settings" IsVisible="{Binding SettingsPageVisible}" Padding="20">
                    <Border BackgroundColor="{DynamicResource MainBackgroundColor}" StrokeShape="RoundRectangle 40" >

                        <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="0,20,0,0">

                            <Grid IsVisible="{Binding SettingsMainHubVisible}" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <VerticalStackLayout Grid.Column="0" Spacing="30">
                                    <Button Text="Change personal data" FontSize="12"
                                            BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                            HorizontalOptions="Center" Clicked="Button_Clicked" 
                                            Command="{Binding OpenPersonalDataEditorCommand}"
                                            TextColor="{DynamicResource TextColor}"/>
                                    <Label Text="Change Theme" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center"/>
                                </VerticalStackLayout>
                                <VerticalStackLayout Grid.Column="1" Spacing="10" Margin="0,10,0,0">
                                    <Label Text="Click to change your personal data" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center"/>
                                    <HorizontalStackLayout Spacing="5" HorizontalOptions="Center">
                                        <Switch Scale="1.3" Margin="0,0,20,0">
                                            <Switch.Behaviors>
                                                <toolkit:EventToCommandBehavior 
                                                        EventName="Toggled"
                                                        Command="{Binding ChangeThemeCommand}"/>
                                            </Switch.Behaviors>
                                        </Switch>
                                        <Label TextColor="{DynamicResource TextColor}" Text="{Binding SwitchThemeMode,Mode=TwoWay}" VerticalOptions="Center"/>
                                    </HorizontalStackLayout>
                                </VerticalStackLayout>
                            </Grid>

                            <Grid IsVisible="{Binding PersonalDataEditorVisible}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="200" />
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Border Grid.Row="0"
                                        StrokeShape="RoundRectangle 30" 
                                        BackgroundColor="{DynamicResource MainBackgroundColor}" 
                                        StrokeThickness="2" WidthRequest="300" HorizontalOptions="Center" Stroke="Gray">
                                    <HorizontalStackLayout>
                                        <VerticalStackLayout Spacing="40"
                                                             BackgroundColor="Transparent" 
                                                             Padding="15">

                                            <Button Text="Change Username" 
                                                    BackgroundColor="Transparent"
                                                    TextColor="{DynamicResource TextColor}"
                                                    FontAttributes="Bold"  FontSize="10"
                                                    Command="{Binding ShowChangeUsernameEntryCommand}">
                                                <Button.Shadow>
                                                    <Shadow Opacity="0.4"
                                                            Radius="10"
                                                            Brush="{DynamicResource TextColor}"/>
                                                </Button.Shadow>
                                                <Button.GestureRecognizers>
                                                    <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" 
                                                                              PointerExited="OptionButtonDescendAnimation"/>
                                                </Button.GestureRecognizers>
                                            </Button>

                                            <Button Text="Change Email" 
                                                    BackgroundColor="Transparent"
                                                    TextColor="{DynamicResource TextColor}"
                                                    FontAttributes="Bold" FontSize="10"
                                                    Command="{Binding ShowChangeEmialEntryCommand}">
                                                <Button.Shadow>
                                                    <Shadow Opacity="0.4"
                                                            Radius="10"
                                                            Brush="{DynamicResource TextColor}"/>
                                                </Button.Shadow>
                                                <Button.GestureRecognizers>
                                                    <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" 
                                                                              PointerExited="OptionButtonDescendAnimation"/>
                                                </Button.GestureRecognizers>
                                            </Button>
                                        </VerticalStackLayout>
                                        <VerticalStackLayout Spacing="40"
                                                             BackgroundColor="Transparent" 
                                                             Padding="10">
                                            <Button Text="Change Password" 
                                                    BackgroundColor="Transparent"
                                                    TextColor="{DynamicResource TextColor}"
                                                    FontAttributes="Bold"
                                                    FontSize="10" Margin="0,5,0,0"
                                                    Command="{Binding ShowChangePasswordEntryCommand}">
                                                <Button.Shadow>
                                                    <Shadow Opacity="0.4"
                                                            Radius="10"
                                                            Brush="{DynamicResource TextColor}"/>
                                                </Button.Shadow>
                                                <Button.GestureRecognizers>
                                                    <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" 
                                                                              PointerExited="OptionButtonDescendAnimation"/>
                                                </Button.GestureRecognizers>
                                            </Button>

                                            <Button Text="Change Profile &#10;Picture"  
                                                    BackgroundColor="Transparent" 
                                                    HorizontalOptions="CenterAndExpand"
                                                    TextColor="{DynamicResource TextColor}"
                                                    FontAttributes="Bold"  FontSize="10"
                                                    LineBreakMode="WordWrap"
                                                    Command="{Binding ChangeProfilePictureCommand}">
                                                <Button.Shadow>
                                                    <Shadow Opacity="0.4"
                                                            Radius="10"
                                                            Brush="{DynamicResource TextColor}"/>
                                                </Button.Shadow>
                                                <Button.GestureRecognizers>
                                                    <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" 
                                                                              PointerExited="OptionButtonDescendAnimation"/>
                                                </Button.GestureRecognizers>
                                            </Button>
                                        </VerticalStackLayout>
                                    </HorizontalStackLayout>
                                </Border>

                                <Grid Grid.Row="1" BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="20">
                                    <Border Stroke="Gray" 
                                            StrokeThickness="1.5" 
                                            StrokeShape="RoundRectangle 20,20,20,20" 
                                            HeightRequest="60" WidthRequest="370"
                                            IsVisible="{Binding ChangeUsernameEntryVisible}"
                                            BackgroundColor="{DynamicResource EntryBackround}"
                                            Scale="0.7">

                                        <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                               FontSize="18"
                                               Placeholder="Username" 
                                               Margin="0" 
                                               HeightRequest="50" 
                                               WidthRequest="350" 
                                               BackgroundColor="Transparent"
                                               PlaceholderColor="Gray"
                                               Text="{Binding ChangedUsername}">
                                        </Entry>
                                    </Border>

                                    <Border Stroke="Gray" 
                                             StrokeThickness="1.5" 
                                             StrokeShape="RoundRectangle 20,20,20,20" 
                                             HeightRequest="60" WidthRequest="370"
                                             IsVisible="{Binding ChangeEmailEntryVisible}"
                                             BackgroundColor="{DynamicResource EntryBackround}"
                                             Scale="0.7">
                                        <Entry  TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                FontSize="18"
                                                Placeholder="E-mial" 
                                                Margin="0" 
                                                HeightRequest="50" 
                                                WidthRequest="350" 
                                                BackgroundColor="Transparent"
                                                PlaceholderColor="Gray"
                                                Text="{Binding ChangedEmail}">
                                        </Entry>
                                    </Border>
                                    <VerticalStackLayout Spacing="10" BackgroundColor="Transparent"
                                                         VerticalOptions="Center"
                                                         Scale="0.7">


                                        <Border Stroke="Gray" 
                                                StrokeThickness="1.5" 
                                                StrokeShape="RoundRectangle 20,20,20,20" 
                                                HeightRequest="60" WidthRequest="370"
                                                IsVisible="{Binding ChangePasswordEntryVisible}"
                                                BackgroundColor="{DynamicResource EntryBackround}">

                                            <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                   FontSize="18"
                                                   Placeholder="Password" 
                                                   IsPassword="True"
                                                   Margin="0" 
                                                   HeightRequest="50" 
                                                   WidthRequest="350" 
                                                   BackgroundColor="Transparent"
                                                   PlaceholderColor="Gray"
                                                   Text="{Binding ChangedPassword}">
                                            </Entry>
                                        </Border>

                                        <Border Stroke="Gray" 
                                                StrokeThickness="1.5" 
                                                StrokeShape="RoundRectangle 20,20,20,20" 
                                                HeightRequest="60" WidthRequest="370"
                                                IsVisible="{Binding ChangePasswordEntryVisible}"
                                                BackgroundColor="{DynamicResource EntryBackround}"
                                                >
                                            <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                   FontSize="18"
                                                   Placeholder="Retype Password" 
                                                   IsPassword="True"
                                                   Margin="0" 
                                                   HeightRequest="50" 
                                                   WidthRequest="350" 
                                                   BackgroundColor="Transparent"
                                                   PlaceholderColor="Gray"
                                                   Text="{Binding ChangedRePassword}">
                                            </Entry>
                                        </Border>
                                    </VerticalStackLayout>

                                    <Grid IsVisible="{Binding ChangeProfilePictureVisible}" Padding="0" BackgroundColor="Blue">
                                        <Border  Stroke="Gray" 
                                                 StrokeThickness="0.5" WidthRequest="300" HeightRequest="300" Margin="0,-60,0,0"
                                                 StrokeShape="RoundRectangle 20"                                                                                       
                                                 BackgroundColor="{DynamicResource EntryBackround}">

                                            <VerticalStackLayout VerticalOptions="Center" 
                                                                 Spacing="10">
                                                <Border StrokeThickness="0" 
                                                        StrokeShape="RoundRectangle 150" 
                                                        HeightRequest="150"  
                                                        WidthRequest="150" 
                                                        BackgroundColor="{DynamicResource MainBackgroundColorContrast}">
                                                    <Image Source="{Binding ChangedImageProfilePicturePath}" 
                                                           HeightRequest="250"  
                                                           WidthRequest="250" 
                                                           Aspect="AspectFill"/>
                                                </Border>
                                                <VerticalStackLayout Spacing="5">
                                                    <Button Command="{Binding ChooseNewProfilePictureCommand}" 
                                                            Text="Choose image..."
                                                            BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                                            TextColor="{DynamicResource TextColor}"
                                                            Margin="5,0,5,0"/>
                                                    <Button Command="{Binding RemoveUserProfilePictureCommand}"
                                                            Text="Remove Current Profile Picture"
                                                            BackgroundColor="#e32441"
                                                            TextColor="White"
                                                            Margin="5,0,5,0"/>
                                                </VerticalStackLayout>
                                            </VerticalStackLayout>
                                        </Border>

                                    </Grid>

                                    <HorizontalStackLayout HorizontalOptions="End" 
                                                           VerticalOptions="End" 
                                                           Spacing="10"
                                                           Margin="100,0,0,0">
                                        <Button Text="Save Changes" 
                                                BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                                VerticalOptions="Center" TextColor="{DynamicResource TextColor}"
                                                Command="{Binding SaveChangedPersonalDataCommand}">
                                            <Button.Shadow>
                                                <Shadow Opacity="0.4"
                                                        Radius="10"/>
                                            </Button.Shadow>
                                        </Button>
                                    </HorizontalStackLayout>
                                    <Button Text="←"
                                            Clicked="Button_Clicked" 
                                            TextColor="{DynamicResource TextColor}" 
                                            Margin="0,0,0,0" 
                                            FontSize="30" 
                                            VerticalOptions="End" 
                                            HorizontalOptions="Start"
                                            BackgroundColor="Transparent"
                                            Command="{Binding OpenSettingsLandingPageCommand}" ZIndex="200"/>
                                </Grid>
                            </Grid>
                        </Grid>
                        <Border.Shadow>
                            <Shadow Opacity="0.5"
                                    Radius="5"/>
                        </Border.Shadow>
                    </Border>
                </Grid>
                <Grid x:Name="OnlineFriends" IsVisible="{Binding OnlineFriendsVisible}">
                    <VerticalStackLayout Padding="10" Spacing="5"
                                         BindableLayout.ItemsSource="{Binding OnlineFriends}"
                                         IsVisible="{Binding NoOnlineFriendsVisible,Converter={StaticResource InverseBooleanConverter}}">
                        <BindableLayout.ItemTemplate>
                            <DataTemplate>
                                <views:OnlineFreidnListElementView Username="{Binding Username}"
                                           UserId="{Binding UserId}"
                                           AvatarImageSource="{Binding AvatarImageSource}"
                                           IsOnline="{Binding IsOnline}"/>
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>
                    </VerticalStackLayout>
                    <Grid HorizontalOptions="Center" VerticalOptions="Center" IsVisible="{Binding NoOnlineFriendsVisible}">
                        <VerticalStackLayout>
                            <Path Data="M 24.15 21.624 c 2.716 -1.706 4.484 -5.014 4.484 -8.074 c 0 -4.362 -3.59 -9.236 -8.396 -9.236 S 11.842 9.188 11.842 13.55 c 0 3.06 1.768 6.37 4.484 8.074 c -6.444 1.73 -11.2 7.614 -11.2 14.596 c 0 0.46 0.378 0.84 0.84 0.84 h 28.546 c 0.46 0 0.84 -0.378 0.84 -0.84 C 35.352 29.238 30.594 23.354 24.15 21.624 M 6.83 35.38 z"
                                  Fill="#afafaf" HorizontalOptions="Center" HeightRequest="200"/>
                            <Label Text="No Friends yet" TextColor="#afafaf" FontSize="15"/>
                        </VerticalStackLayout>
                    </Grid>
                </Grid>
                <Grid x:Name="Notifications" IsVisible="{Binding NotificationsPageVisible}">
                    <VerticalStackLayout BackgroundColor="{DynamicResource SideBackgroundColor}" 
                                         IsVisible="{Binding NoNotificationNotifierVisible,Converter={StaticResource InverseBooleanConverter}}">
                        <Grid Padding="10">
                            <Grid x:Name="ClearButtonGrid_Android">
                                <Button Text="Clear" 
                                        Background="{DynamicResource MainBackgroundColor}" 
                                        TextColor="{DynamicResource TextColor}" 
                                        FontSize="15"
                                        Command="{Binding ClearNotificationsCommand}"
                                        WidthRequest="{Binding Source={x:Reference ClearButtonGrid_Android},Path=Width}">
                                    <Button.Shadow>
                                        <Shadow Opacity="0.3" 
                                                Brush="{DynamicResource TextColor}"/>
                                    </Button.Shadow>
                                </Button>
                            </Grid>
                        </Grid>
                        <Grid   HorizontalOptions="Start" 
                                VerticalOptions="Start" 
                                BackgroundColor="Transparent"
                                WidthRequest="{Binding Source={x:Reference Page},Path=Width}"
                                HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource LeftBarHeightAdjustValue}}" >
                            <Grid BackgroundColor="Transparent" 
                                  Padding="0,10,0,10">
                                <CollectionView ItemTemplate="{StaticResource NotificationTemplateSelector}" 
                                                ItemsSource="{Binding Notifications}" 
                                                BackgroundColor="Transparent"
                                                VerticalScrollBarVisibility="Always"
                                                ItemsUpdatingScrollMode="KeepScrollOffset"
                                                RemainingItemsThreshold="5"
                                                RemainingItemsThresholdReachedCommand="{Binding NotificationsThresholdExceedCommand}"
                                                Scrolled="CollectionView_Scrolled"
                                                Margin="10,0,10,0">
                                    <CollectionView.ItemsLayout>
                                        <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                    </CollectionView.ItemsLayout>
                                </CollectionView>
                            </Grid>
                        </Grid>
                    </VerticalStackLayout>
                    <Grid IsVisible="{Binding NoNotificationNotifierVisible}"
                          HorizontalOptions="FillAndExpand" 
                          VerticalOptions="Start"
                          BackgroundColor="{DynamicResource SideBackgroundColor}"
                          HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource NoNotificationsHeightAdjustValue}}" >
                        <VerticalStackLayout VerticalOptions="Center" >
                            <Image Source="notificationicon.png" HeightRequest="40" WidthRequest="40" HorizontalOptions="Center"/>
                            <Label TextColor="#afafaf" Text="No notification yet" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Grid>
                </Grid>
            </Grid>

            <Grid IsVisible="{Binding SearchPanelVisible}" Grid.Row="1">
                <ScrollView BackgroundColor="{DynamicResource MainBackgroundColorContrast}" Margin="0,0,0,0">
                    <VerticalStackLayout>
                        <Button Text="Back" 
                                TextColor="{DynamicResource TextColor}" 
                                HeightRequest="40"
                                Padding="0"
                                FontSize="20"
                                BackgroundColor="{DynamicResource MainBackgroundColor}" Margin="10"
                                Clicked="Android_search_entry_unfocus"/>
                        <VerticalStackLayout Spacing="20" Padding="10" BindableLayout.ItemsSource="{Binding SearchResults}">
                        
                            <BindableLayout.ItemTemplate>
                                <DataTemplate>
                                    <views:UserSearchResultView Username="{Binding Username}"
                                                 Follows="{Binding Follows}"
                                                 Friends="{Binding Friends}"
                                                 PfpImageBase64="{Binding PfpImageBase64}"/>
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </ScrollView>
            </Grid>
        </Grid>
    
        <Grid IsVisible="{OnPlatform Android=False}">
        <Grid >
            <Grid.RowDefinitions>
                <RowDefinition Height="100"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Grid ZIndex="10" Grid.Row="0">
                <BoxView Color="{DynamicResource MainBackgroundColor}" 
                          WidthRequest="{Binding Source={x:Reference Page},Path=Width}" 
                          HeightRequest="100" 
                          VerticalOptions="Start">
                    <BoxView.Shadow>
                        <Shadow Opacity="0.8"/>
                    </BoxView.Shadow>
                </BoxView>

                <ImageButton Source="{DynamicResource LogoPath}" 
                             HeightRequest="50" 
                             WidthRequest="50" 
                             VerticalOptions="Start" 
                             HorizontalOptions="Start" 
                             Margin="20"
                             BackgroundColor="Transparent"/>
                
                <Border Margin="0,20,0,0" 
                        VerticalOptions="Start" 
                        Stroke="Gray" 
                        StrokeThickness="1.5" 
                        StrokeShape="RoundRectangle 20,20,20,20" 
                        HeightRequest="50" 
                        WidthRequest="420">
                    <Grid BackgroundColor="{DynamicResource EntryBackround}">
                        <Entry TextColor="{DynamicResource TextColor}" 
                               FontSize="18" 
                               Placeholder="Search" 
                               Margin="0" 
                               HeightRequest="40" 
                               WidthRequest="400" 
                               Text="{Binding SearchParam,Mode=TwoWay}"
                               x:Name="SearchEntry"
                               BackgroundColor="Transparent"
                               >
                            <Entry.Behaviors>
                                <toolkit:EventToCommandBehavior EventName="Focused" Command="{Binding ShowSearchPanelCommand}"/>
                                <toolkit:EventToCommandBehavior EventName="Unfocused" Command="{Binding HideSearchPanelCommand}"/>
                                <toolkit:EventToCommandBehavior EventName="TextChanged" Command="{Binding SearchCommand}"/>
                            </Entry.Behaviors>
                            <Entry.GestureRecognizers>
                                <PointerGestureRecognizer PointerEnteredCommand="{Binding SetSearchPanelVisibilityToTrueCommand}"
                                                          PointerExitedCommand="{Binding SetSearchPanelVisibilityToFalseCommand}"/>
                            </Entry.GestureRecognizers>
                        </Entry>
                    </Grid>
                </Border>

                
                <Border HorizontalOptions="Start" Margin="100,0,0,0" StrokeShape="RoundRectangle 5" BackgroundColor="#80808080" WidthRequest="42" HeightRequest="42">
                    <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" WidthRequest="41" HeightRequest="41">
                        <VerticalStackLayout Spacing="4" VerticalOptions="Center">
                            <BoxView BackgroundColor="Gray" WidthRequest="22" HeightRequest="3" Opacity="0.8" CornerRadius="50"/>
                            <BoxView BackgroundColor="Gray" WidthRequest="22" HeightRequest="3" Opacity="0.8" CornerRadius="50"/>
                            <BoxView BackgroundColor="Gray" WidthRequest="22" HeightRequest="3" Opacity="0.8" CornerRadius="50"/>
                        </VerticalStackLayout>
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ShowHubPanelCommand}"/>
                        </Grid.GestureRecognizers>
                    </Grid>
                    <Border.Shadow>
                        <Shadow Opacity="0.4" Brush="Black"/>
                    </Border.Shadow>
                </Border>

                <Border Margin="0,0,50,0" HorizontalOptions="End" StrokeShape="RoundRectangle 40" WidthRequest="64" HeightRequest="64" Stroke="{DynamicResource TextColor}" StrokeThickness="1"> 
                    <Image HeightRequest="60"
                           WidthRequest="60"
                           Source="{Binding ProfilePictureSource}" 
                           Aspect="Fill"
                           BackgroundColor="{DynamicResource MainBackgroundColorContrast}"/>
                </Border>
                
            </Grid>

            <Grid Padding="0,0,0,0"  Grid.Row="1">
                    <!--left for some pages buttons or custom flyout | middle for posts | left for friends-->
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0">
                        <VerticalStackLayout BackgroundColor="{DynamicResource SideBackgroundColor}" 
                                         IsVisible="{Binding NoNotificationNotifierVisible,Converter={StaticResource InverseBooleanConverter}}">

                            <HorizontalStackLayout BackgroundColor="{DynamicResource SideBackgroundColor}" 
                                                   Spacing="5" 
                                                   Padding="10"
                                                   HeightRequest="70">
                                <Label Text="Notfications" TextColor="{DynamicResource TextColor}" FontAttributes="Bold" FontSize="30" />
                                <Button Text="Clear" Background="{DynamicResource MainBackgroundColor}" 
                                        TextColor="{DynamicResource TextColor}" 
                                        Scale="0.7" 
                                        WidthRequest="100"
                                        FontSize="15"
                                        Command="{Binding ClearNotificationsCommand}">
                                    <Button.Shadow>
                                        <Shadow Opacity="0.3" Brush="{DynamicResource TextColor}"/>
                                    </Button.Shadow>
                                </Button>
                            </HorizontalStackLayout>
                            <Grid   HorizontalOptions="Start" 
                                    VerticalOptions="Start" 
                                    x:Name="hubScroll" 
                                    BackgroundColor="Transparent"
                                    WidthRequest="300" 
                                    HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource LeftBarHeightAdjustValue}}" >
                                <!--pages-->
                                <Grid BackgroundColor="Transparent" Padding="0,10,0,10" x:Name="NotificationsGrid">
                                    <CollectionView ItemTemplate="{StaticResource NotificationTemplateSelector}" 
                                                ItemsSource="{Binding Notifications}" 
                                                BackgroundColor="Transparent"
                                                VerticalScrollBarVisibility="Always"
                                                ItemsUpdatingScrollMode="KeepScrollOffset"
                                                RemainingItemsThreshold="5"
                                                RemainingItemsThresholdReachedCommand="{Binding NotificationsThresholdExceedCommand}"
                                                Scrolled="CollectionView_Scrolled"
                                                HeightRequest="{Binding Source={x:Reference NotificationsGrid},Path=Height}">
                                        <CollectionView.ItemsLayout>
                                            <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                        </CollectionView.ItemsLayout>
                                    </CollectionView>
                                    <!--<CollectionView ItemTemplate="{StaticResource NotificationTemplateSelector}" 
                                                ItemsSource="{Binding Notifications}" 
                                                BackgroundColor="Transparent"
                                                VerticalScrollBarVisibility="Always"
                                                ItemsUpdatingScrollMode="KeepScrollOffset"
                                                RemainingItemsThreshold="5"
                                                RemainingItemsThresholdReachedCommand="{Binding NotificationsThresholdExceedCommand}"
                                                >
                                    <CollectionView.ItemsLayout>
                                        <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                    </CollectionView.ItemsLayout>
                                </CollectionView>-->
                                </Grid>
                            </Grid>
                        </VerticalStackLayout>

                        <Grid IsVisible="{Binding NoNotificationNotifierVisible}"
                          HorizontalOptions="Start" 
                          VerticalOptions="Start"
                          BackgroundColor="{DynamicResource SideBackgroundColor}"
                          WidthRequest="300"
                          Margin="0,0,0,0"
                          HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource NoNotificationsHeightAdjustValue}}" >
                            <VerticalStackLayout VerticalOptions="Center" >
                                <Image Source="notificationicon.png" HeightRequest="40" WidthRequest="40" HorizontalOptions="Center"/>
                                <Label TextColor="#afafaf" Text="No notification yet" HorizontalOptions="Center"/>
                            </VerticalStackLayout>
                        </Grid>
                        <!--<a target="_blank" href="https://icons8.com/icon/83193/notification">Notification</a> icon by
                    <a target="_blank" href="https://icons8.com">Icons8</a>-->
                    </Grid>

                    <ScrollView Grid.Column="1"
                            IsVisible="{Binding PostPageVisible,Converter={StaticResource InverseBooleanConverter}}"
                            BackgroundColor="{DynamicResource MainBackgroundColor}"
                            WidthRequest="{Binding Source={x:Reference Page},Path=Width,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource MidBarWidthAdjustValue}}">

                        <Grid>
                            <Grid x:Name="ProfileGrid" IsVisible="{Binding ProfilePageVisible}" BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="30">
                                <VerticalStackLayout>
                                    <Border ZIndex="1" 
                                        MaximumWidthRequest="1000" 
                                        VerticalOptions="Start" 
                                        HeightRequest="300" 
                                        BackgroundColor="{DynamicResource MainBackgroundColor}"
                                        StrokeShape="RoundRectangle 40">
                                        <Grid  Padding="15"  
                                           BackgroundColor="{DynamicResource MainBackgroundColor}" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>
                                            <ImageButton Grid.Column="0"
                                                     BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                                     CornerRadius="100"
                                                     HeightRequest="200" 
                                                     WidthRequest="200"  
                                                     Source="{Binding AvatarBase64}" 
                                                     Aspect="AspectFill"
                                                     BorderWidth="1"
                                                     BorderColor="{DynamicResource TextColor}"/>
                                            <VerticalStackLayout Padding="5" 
                                                             VerticalOptions="Center" 
                                                             BackgroundColor="Transparent" 
                                                             Grid.Column="1">

                                                <Label Text="{Binding ProfileUsername}" 
                                                   TextColor="{DynamicResource TextColor}" 
                                                   FontSize="30" 
                                                   FontAttributes="Bold"/>

                                                <Label Text="{Binding ProfileFriends}" 
                                                   TextColor="{DynamicResource TextColor}"
                                                   FontSize="15" 
                                                   Margin="4,0,0,0"/>

                                                <Label Text="{Binding ProfileFollowers}" 
                                                   TextColor="{DynamicResource TextColor}" 
                                                   FontSize="15" 
                                                   Margin="4,0,0,0"/>
                                            </VerticalStackLayout>

                                            <HorizontalStackLayout IsVisible="{Binding ProfileAddFriendAndFollowButtonsVisible}"
                                                               HorizontalOptions="End" 
                                                               VerticalOptions="Center"
                                                               Padding="10" 
                                                               Grid.Column="2">
                                                <Button FontAttributes="Bold" 
                                                    Text="Send friend request" 
                                                    BackgroundColor="#e0e0e0" 
                                                    Margin="0,0,10,0">
                                                    <Button.Shadow>
                                                        <Shadow Opacity="0.4"
                                                            Radius="10"/>
                                                    </Button.Shadow>
                                                    <Button.GestureRecognizers>
                                                        <PointerGestureRecognizer PointerEntered="ScaleButtonSizeAnimation" 
                                                                              PointerExited="CondenseButtonSizeAnimation"/>
                                                    </Button.GestureRecognizers>
                                                </Button>

                                                <Button FontAttributes="Bold" 
                                                    Text="Follow" 
                                                    BackgroundColor="#e32441" 
                                                    Margin="0,0,10,0">
                                                    <Button.Shadow>
                                                        <Shadow Opacity="0.4"
                                                            Radius="10"/>
                                                    </Button.Shadow>
                                                    <Button.GestureRecognizers>
                                                        <PointerGestureRecognizer PointerEntered="ScaleButtonSizeAnimation" 
                                                                              PointerExited="CondenseButtonSizeAnimation"/>
                                                    </Button.GestureRecognizers>
                                                </Button>

                                            </HorizontalStackLayout>
                                        </Grid>
                                        <Border.Shadow>
                                            <Shadow Opacity="0.5"
                                                Radius="10"/>
                                        </Border.Shadow>

                                    </Border>

                                    <Border Margin="0,-40,0,0" 
                                        ZIndex="0" 
                                        BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                        MaximumWidthRequest="1000" 
                                        VerticalOptions="Start" 
                                        HeightRequest="125"  
                                        StrokeShape="RoundRectangle 0,0,40,40">
                                        <Grid Padding="15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                                <ColumnDefinition />
                                            </Grid.ColumnDefinitions>

                                            <Grid Padding="5" 
                                              VerticalOptions="End"  
                                              Grid.Column="0">
                                                <Button Command="{Binding ShowProfilePostsCommand}" 
                                                    Text="Post" 
                                                    HeightRequest="40" 
                                                    FontAttributes="Bold" 
                                                    FontSize="20"
                                                    TextColor="{DynamicResource TextColor}"
                                                    BackgroundColor="{Binding SelfPostButtonColor}">
                                                    <Button.Shadow>
                                                        <Shadow Opacity="0.4" 
                                                            Radius="5"/>
                                                    </Button.Shadow>
                                                </Button>
                                            </Grid>

                                            <Grid Padding="5" 
                                              VerticalOptions="End" 
                                              Grid.Column="1" >
                                                <Button Command="{Binding ShowProfileFriendsCommand}" 
                                                    Text="Friends" 
                                                    HeightRequest="40" 
                                                    FontAttributes="Bold" 
                                                    FontSize="20"
                                                    TextColor="{DynamicResource TextColor}"
                                                    BackgroundColor="{Binding FriendsButtonColor}">
                                                    <Button.Shadow>
                                                        <Shadow Opacity="0.4" 
                                                            Radius="5"/>
                                                    </Button.Shadow>
                                                </Button>
                                            </Grid>

                                            <Grid Padding="5" VerticalOptions="End" Grid.Column="2" >
                                                <Button Command="{Binding ShowProfileFollowersCommand}" 
                                                    Text="Followers" 
                                                    HeightRequest="40" 
                                                    FontAttributes="Bold" 
                                                    FontSize="20" 
                                                     TextColor="{DynamicResource TextColor}"
                                                    BackgroundColor="{Binding FollowersButtonColor}">
                                                    <Button.Shadow>
                                                        <Shadow Opacity="0.4" Radius="5"/>
                                                    </Button.Shadow>
                                                </Button>
                                            </Grid>

                                        </Grid>
                                        <Border.Shadow>
                                            <Shadow Opacity="0.4" Brush="Black"/>
                                        </Border.Shadow>
                                    </Border>

                                    <VerticalStackLayout x:Name="ProfileSection">
                                        <Border IsVisible="{Binding ProfileFriendsVisible}" 
                                            x:Name="FriendsUniformGridBorder"
                                            Margin="0,50,0,0" 
                                            BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                            StrokeShape="RoundRectangle 40,40,40,40" 
                                            MaximumWidthRequest="1200" MinimumHeightRequest="500">
                                            <Grid>
                                                <toolkit:UniformItemsLayout MaxColumns="3"
                                                                    BackgroundColor="Transparent" 
                                                                    HeightRequest="1000" 
                                                                    Padding="20" 
                                                                    BindableLayout.ItemsSource="{Binding ProfileFriendsList}" 
                                                                    x:Name="FriendsUniformGrid"
                                                                    IsVisible="{Binding NoProfileFriendsVisible,Converter={StaticResource InverseBooleanConverter}}">
                                                    <BindableLayout.ItemTemplate>
                                                        <DataTemplate>
                                                            <views:OnListFriendView Username="{Binding Username}"
                                                                                    AvatarImageSource="{Binding AvatarImageSource}"
                                                                                    UserId="{Binding UserId}"
                                                                                    Margin="0,5"/>
                                                        </DataTemplate>
                                                    </BindableLayout.ItemTemplate>
                                                </toolkit:UniformItemsLayout>
                                                <Grid IsVisible="{Binding NoProfileFriendsVisible}" HorizontalOptions="Center" VerticalOptions="Center">
                                                    <Label Text="This user has no friends." TextColor="{DynamicResource TextColor}" FontSize="30"/>
                                                </Grid>
                                            </Grid>
                                            <Border.Shadow>
                                                <Shadow Opacity="0.4" Brush="Black"/>
                                            </Border.Shadow>
                                        </Border>

                                        <Grid IsVisible="{Binding ProfilePostsVisible}" >
                                            <StackLayout Orientation="Vertical" 
                                                     x:Name="ProfilePostGrid"     
                                                     IsVisible="{Binding NoPostOnProfile,Converter={StaticResource InverseBooleanConverter}}"
                                                     BindableLayout.ItemsSource="{Binding ProfilePosts}">
                                                <BindableLayout.ItemTemplate>
                                                    <DataTemplate>
                                                        <views:PostView Username="{Binding Username}"
                                                                    TimeStamp="{Binding TimeStamp}"
                                                                    PostTextContent="{Binding PostTextContent}"
                                                                    PostLikeCount="{Binding PostLikeCount}"
                                                                    ImageSource="{Binding ImageSource}"
                                                                    ImagesBase64="{Binding ImagesBase64}"
                                                                    PfpImageBase64="{Binding PfpImageBase64}"
                                                                    PostId="{Binding PostId}"
                                                                    NewCommentContent="{Binding NewCommentContent}"
                                                                    Payload="{Binding Payload}"
                                                                    DeleteButtonVisible="{Binding DeleteButtonVisible}"
                                                                    PostProducts="{Binding PostProducts}"
                                                                    PostContentVisible="{Binding PostContentVisible}"
                                                                    PostImagesVisible="{Binding PostImagesVisible}"
                                                                    LikePostCommand="{Binding LikePostCommand}"
                                                                    UnlikePostCommand="{Binding UnlikePostCommand}"
                                                                    SaveRecipeCommand="{Binding SaveRecipeCommand}"
                                                                    UnsaveRecipeCommand="{Binding UnsaveRecipeCommand}"
                                                                    LikingCommand="{Binding LikingCommand}"
                                                                    SavingCommand="{Binding SavingCommand}"
                                                                    LikeText="{Binding LikeText}"
                                                                    SavingText="{Binding SavingText}"
                                                                    SaveIconPathFill="{Binding SaveIconPathFill}"
                                                                    IsLiked="{Binding IsLiked}"
                                                                    IsSaved="{Binding IsSaved}"/>
                                                    </DataTemplate>
                                                </BindableLayout.ItemTemplate>
                                            </StackLayout>
                                            <Label Text="This user has no posts yet." Margin="0,200,0,0"
                                                   FontSize="30" 
                                                   TextColor="{DynamicResource TextColor}"
                                                   IsVisible="{Binding NoPostOnProfile}" VerticalOptions="Center" HorizontalOptions="Center"/>
                                        </Grid>


                                        <Border IsVisible="{Binding ProfileFollowersVisible}" 
                                            Margin="0,50,0,0" 
                                            BackgroundColor="{DynamicResource ProfileOptionsSection}" 
                                            StrokeShape="RoundRectangle 40,40,40,40" 
                                            MaximumWidthRequest="1200" MinimumHeightRequest="500">
                                            <Grid>
                                                <toolkit:UniformItemsLayout MaxColumns="3" 
                                                                        BackgroundColor="Transparent" 
                                                                        HeightRequest="1000"
                                                                        Padding="20" 
                                                                        BindableLayout.ItemsSource="{Binding ProfileFollowersList}"
                                                                        IsVisible="{Binding NoProfileFollowersVisible,Converter={StaticResource InverseBooleanConverter}}">
                                                    <BindableLayout.ItemTemplate>
                                                        <DataTemplate>
                                                            <views:OnListFriendView Username="{Binding Username}"
                                                                                AvatarImageSource="{Binding AvatarImageSource}"
                                                                                UserId="{Binding UserId}"
                                                                                Margin="0,5"/>
                                                        </DataTemplate>
                                                    </BindableLayout.ItemTemplate>
                                                </toolkit:UniformItemsLayout>
                                                <Grid IsVisible="{Binding NoProfileFollowersVisible}" HorizontalOptions="Center" VerticalOptions="Center">
                                                    <Label Text="This user has no followers." TextColor="{DynamicResource TextColor}" FontSize="30"/>
                                                </Grid>
                                            </Grid>
                                            <Border.Shadow>
                                                <Shadow Opacity="0.4" Brush="Black"/>
                                            </Border.Shadow>
                                        </Border>

                                        <Grid VerticalOptions="Center" HorizontalOptions="Center">

                                            <VerticalStackLayout Margin="0,100,0,0">
                                                <Label TextColor="{DynamicResource TextColor}" 
                                                   Text="Loading..." 
                                                   IsVisible="{Binding LoadingLabelVisible}"/>
                                                <ActivityIndicator IsRunning="True" IsVisible="{Binding LoadingLabelVisible}" Color="{DynamicResource TextColor}"/>
                                            </VerticalStackLayout>
                                        </Grid>
                                    </VerticalStackLayout>
                                </VerticalStackLayout>
                            </Grid>


                            <Grid IsVisible="{Binding SettingsPageVisible}" Padding="40">
                                <Border BackgroundColor="{DynamicResource MainBackgroundColor}" StrokeShape="RoundRectangle 40" MaximumWidthRequest="1000">

                                    <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="20">

                                        <Grid x:Name="settingsOptionsGrid" IsVisible="{Binding SettingsMainHubVisible}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>


                                            <VerticalStackLayout Grid.Column="0" Spacing="10">
                                                <Button TextColor="{DynamicResource TextColor}" Text="Change personal data" BackgroundColor="{DynamicResource MainBackgroundColorContrast}" HorizontalOptions="Center" Clicked="Button_Clicked" Command="{Binding OpenPersonalDataEditorCommand}"/>
                                                <Label Text="Change Theme" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center"/>
                                            </VerticalStackLayout>
                                            <VerticalStackLayout Grid.Column="1" Spacing="10" Margin="0,10,0,0">
                                                <Label Text="Click to change your personal data" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center"/>
                                                <HorizontalStackLayout Spacing="5" HorizontalOptions="Center">
                                                    <Switch Scale="1.5">
                                                        <Switch.Behaviors>
                                                            <toolkit:EventToCommandBehavior 
                                                                        EventName="Toggled" 
                                                                        Command="{Binding ChangeThemeCommand}"/>
                                                        </Switch.Behaviors>
                                                    </Switch>
                                                    <Label TextColor="{DynamicResource TextColor}" Text="{Binding SwitchThemeMode,Mode=TwoWay}" VerticalOptions="Center"/>
                                                </HorizontalStackLayout>
                                            </VerticalStackLayout>

                                        </Grid>

                                        <Grid x:Name="changePersonalDataGrid" IsVisible="{Binding PersonalDataEditorVisible}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" StrokeShape="RoundRectangle 30" BackgroundColor="Gray" StrokeThickness="2">
                                                <VerticalStackLayout Spacing="40"  BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="20">

                                                    <Button Text="Change Username" 
                                                        BackgroundColor="Transparent"
                                                        TextColor="{DynamicResource TextColor}"
                                                        FontAttributes="Bold"
                                                        Command="{Binding ShowChangeUsernameEntryCommand}">
                                                        <Button.Shadow>
                                                            <Shadow Opacity="0.4"
                                                                Radius="10"
                                                                Brush="{DynamicResource TextColor}"/>
                                                        </Button.Shadow>
                                                        <Button.GestureRecognizers>
                                                            <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" PointerExited="OptionButtonDescendAnimation"/>
                                                        </Button.GestureRecognizers>
                                                    </Button>

                                                    <Button Text="Change Email" 
                                                        BackgroundColor="Transparent"
                                                        TextColor="{DynamicResource TextColor}"
                                                        FontAttributes="Bold"
                                                        Command="{Binding ShowChangeEmialEntryCommand}">
                                                        <Button.Shadow>
                                                            <Shadow Opacity="0.4"
                                                                Radius="10"
                                                                Brush="{DynamicResource TextColor}"/>
                                                        </Button.Shadow>
                                                        <Button.GestureRecognizers>
                                                            <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" PointerExited="OptionButtonDescendAnimation"/>
                                                        </Button.GestureRecognizers>
                                                    </Button>

                                                    <Button Text="Change Password" 
                                                        BackgroundColor="Transparent"
                                                        TextColor="{DynamicResource TextColor}"
                                                        FontAttributes="Bold"
                                                        Command="{Binding ShowChangePasswordEntryCommand}">
                                                        <Button.Shadow>
                                                            <Shadow Opacity="0.4"
                                                                Radius="10"
                                                                Brush="{DynamicResource TextColor}"/>
                                                        </Button.Shadow>
                                                        <Button.GestureRecognizers>
                                                            <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" PointerExited="OptionButtonDescendAnimation"/>
                                                        </Button.GestureRecognizers>
                                                    </Button>

                                                    <Button Text="Change Profile Picture"  
                                                        BackgroundColor="Transparent" 
                                                        HorizontalOptions="CenterAndExpand"
                                                        TextColor="{DynamicResource TextColor}"
                                                        FontAttributes="Bold" 
                                                        LineBreakMode="WordWrap"
                                                        Command="{Binding ChangeProfilePictureCommand}">
                                                        <Button.Shadow>
                                                            <Shadow Opacity="0.4"
                                                                Radius="10"
                                                                Brush="{DynamicResource TextColor}"/>
                                                        </Button.Shadow>
                                                        <Button.GestureRecognizers>
                                                            <PointerGestureRecognizer PointerEntered="OptionButtonScaleAnimation" PointerExited="OptionButtonDescendAnimation"/>
                                                        </Button.GestureRecognizers>
                                                    </Button>



                                                </VerticalStackLayout>
                                            </Border>

                                            <Grid Grid.Column="1" BackgroundColor="{DynamicResource MainBackgroundColor}" Padding="20">
                                                <!--<VerticalStackLayout Spacing="10" Padding="20" VerticalOptions="Center"  BackgroundColor="Blue">-->

                                                <Border Stroke="Gray" 
                                                    StrokeThickness="1.5" 
                                                    StrokeShape="RoundRectangle 20,20,20,20" 
                                                    HeightRequest="60" WidthRequest="370"
                                                    IsVisible="{Binding ChangeUsernameEntryVisible}"
                                                    BackgroundColor="{DynamicResource EntryBackround}">

                                                    <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                       FontSize="18"
                                                       Placeholder="Username" 
                                                       Margin="0" 
                                                       x:Name="newUsernameEntry" 
                                                       HeightRequest="50" 
                                                       WidthRequest="350" 
                                                       BackgroundColor="Transparent"
                                                       PlaceholderColor="Gray"
                                                       Text="{Binding ChangedUsername}">
                                                    </Entry>
                                                </Border>

                                                <Border Stroke="Gray" 
                                                     StrokeThickness="1.5" 
                                                     StrokeShape="RoundRectangle 20,20,20,20" 
                                                     HeightRequest="60" WidthRequest="370"
                                                     IsVisible="{Binding ChangeEmailEntryVisible}"
                                                     BackgroundColor="{DynamicResource EntryBackround}">
                                                    <Entry 
                                                    TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                    FontSize="18"
                                                    Placeholder="E-mial" 
                                                    Margin="0" 
                                                    x:Name="newEmailEntry" 
                                                    HeightRequest="50" 
                                                    WidthRequest="350" 
                                                    BackgroundColor="Transparent"
                                                    PlaceholderColor="Gray"
                                                    Text="{Binding ChangedEmail}">
                                                    </Entry>
                                                </Border>
                                                <VerticalStackLayout Spacing="10" VerticalOptions="Center">


                                                    <Border Stroke="Gray" 
                                                     StrokeThickness="1.5" 
                                                     StrokeShape="RoundRectangle 20,20,20,20" 
                                                     HeightRequest="60" WidthRequest="370"
                                                     IsVisible="{Binding ChangePasswordEntryVisible}"
                                                     BackgroundColor="{DynamicResource EntryBackround}">

                                                        <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                        FontSize="18"
                                                        Placeholder="Password" 
                                                        IsPassword="True"
                                                        Margin="0" 
                                                        x:Name="newPasswordEntry" 
                                                        HeightRequest="50" 
                                                        WidthRequest="350" 
                                                        BackgroundColor="Transparent"
                                                        PlaceholderColor="Gray"
                                                        Text="{Binding ChangedPassword}">
                                                        </Entry>
                                                    </Border>

                                                    <Border Stroke="Gray" 
                                                         StrokeThickness="1.5" 
                                                         StrokeShape="RoundRectangle 20,20,20,20" 
                                                         HeightRequest="60" WidthRequest="370"
                                                         IsVisible="{Binding ChangePasswordEntryVisible}"
                                                         BackgroundColor="{DynamicResource EntryBackround}">
                                                        <Entry TextColor="{DynamicResource NotificationButtonTextColor}" 
                                                            FontSize="18"
                                                            Placeholder="Retype Password" 
                                                            IsPassword="True"
                                                            Margin="0" 
                                                            x:Name="newRePasswordEntry" 
                                                            HeightRequest="50" 
                                                            WidthRequest="350" 
                                                            BackgroundColor="Transparent"
                                                            PlaceholderColor="Gray"
                                                            Text="{Binding ChangedRePassword}">
                                                        </Entry>
                                                    </Border>
                                                </VerticalStackLayout>

                                                <Grid IsVisible="{Binding ChangeProfilePictureVisible}" Padding="50">
                                                    <Border  Stroke="Gray" 
                                                         StrokeThickness="0.5" 
                                                         StrokeShape="RoundRectangle 20"                                                                                       
                                                         BackgroundColor="{DynamicResource EntryBackround}">

                                                        <VerticalStackLayout VerticalOptions="Center" 
                                                                         Spacing="10">
                                                            <Border StrokeThickness="0" 
                                                                StrokeShape="RoundRectangle 150" 
                                                                HeightRequest="250"  
                                                                WidthRequest="250" 
                                                                BackgroundColor="{DynamicResource MainBackgroundColorContrast}">
                                                                <Image Source="{Binding ChangedImageProfilePicturePath}" 
                                                                   HeightRequest="250"  
                                                                   WidthRequest="250" 
                                                                   Aspect="AspectFill"/>


                                                            </Border>
                                                            <VerticalStackLayout Spacing="5">
                                                                <Button Command="{Binding ChooseNewProfilePictureCommand}" 
                                                                    Text="Choose image..."
                                                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                                                    TextColor="{DynamicResource TextColor}"
                                                                    Margin="5,0,5,0"/>
                                                                <Button Command="{Binding RemoveUserProfilePictureCommand}"
                                                                    Text="Remove Current Profile Picture"
                                                                    BackgroundColor="#e32441"
                                                                    TextColor="White"/>
                                                            </VerticalStackLayout>
                                                        </VerticalStackLayout>
                                                    </Border>

                                                </Grid>

                                                <HorizontalStackLayout HorizontalOptions="End" 
                                                                   VerticalOptions="End" 
                                                                   Spacing="10">
                                                    <Button Text="Save Changes" 
                                                        BackgroundColor="#e0e0e0" 
                                                        VerticalOptions="Center"
                                                        Command="{Binding SaveChangedPersonalDataCommand}">
                                                        <Button.Shadow>
                                                            <Shadow Opacity="0.4"
                                                                Radius="10"/>
                                                        </Button.Shadow>
                                                    </Button>
                                                </HorizontalStackLayout>
                                                <Button Text="←"
                                                    Clicked="Button_Clicked" 
                                                    TextColor="{DynamicResource TextColor}" 
                                                    BackgroundColor="Transparent"
                                                    Margin="0,-25,0,0" 
                                                    FontSize="30" 
                                                    VerticalOptions="Start" 
                                                    HorizontalOptions="End" 
                                                    Command="{Binding OpenSettingsLandingPageCommand}"/>
                                                <!--</VerticalStackLayout>-->
                                            </Grid>
                                        </Grid>
                                    </Grid>
                                    <Border.Shadow>
                                        <Shadow Opacity="0.5"
                                            Radius="5"/>
                                    </Border.Shadow>
                                </Border>
                            </Grid>

                            <Grid Grid.Column="1" 
                              IsVisible="{Binding RecipePageVisible}"
                              BackgroundColor="{DynamicResource MainBackgroundColor}"
                              Padding="30,5,30,30"
                              x:Name="RecipeGrid"
                              WidthRequest="{Binding Source={x:Reference Page},Path=Width,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource MidBarWidthAdjustValue}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="100"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Frame BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                   HeightRequest="50" WidthRequest="230"
                                   BorderColor="Transparent"
                                   Grid.Row="0"
                                   Margin="0,-10,0,0" Padding="5" CornerRadius="30">

                                    <Grid ColumnSpacing="5">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <Button Text="Liked" 
                                            Grid.Column="0" 
                                            TextColor="{DynamicResource TextColor}" 
                                            MinimumHeightRequest="0" 
                                            MinimumWidthRequest="0" 
                                            HeightRequest="25" 
                                            WidthRequest="90"
                                            FontSize="15" 
                                            Padding="0"
                                            BackgroundColor="{Binding LikedRecipesButtonBackround}"
                                            Command="{Binding ShowLikedRecipesCommand}"/>
                                        <Button Text="Saved" 
                                            Grid.Column="1" 
                                            TextColor="{DynamicResource TextColor}" 
                                            MinimumHeightRequest="0" 
                                            MinimumWidthRequest="0" 
                                            HeightRequest="25" 
                                            WidthRequest="90"
                                            FontSize="15" 
                                            Padding="0"
                                            BackgroundColor="{Binding SavedRecipesButtonBackround}"
                                            Command="{Binding ShowSavedRecipesCommand}"/>
                                    </Grid>
                                </Frame>
                                <Grid Grid.Row="1"  IsVisible="{Binding LikedRecipesVisible}">
                                    <CollectionView Grid.Row="1"
                                                ItemsSource="{Binding LikedRecipes}" IsVisible="{Binding NoLikedRecipes,Converter={StaticResource InverseBooleanConverter}}"
                                                RemainingItemsThreshold="5"
                                                ItemsUpdatingScrollMode="KeepScrollOffset"
                                                RemainingItemsThresholdReachedCommand="{Binding RecipesItemsThresholdExceedCommand}" 
                                                RemainingItemsThresholdReachedCommandParameter="{x:Static viewmodel:RecipeType.Liked}"
                                                WidthRequest="{Binding Source={x:Reference RecipeGrid},Path=Width}"
                                                HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource RecipeCollectionViewHeightAdjustValue}}">
                                        <CollectionView.ItemsLayout>
                                            <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                        </CollectionView.ItemsLayout>
                                        <CollectionView.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Padding="20,0,20,0">
                                                    <views:RecipeView Id="{Binding Id}"
                                                                  Username="{Binding Username}"
                                                                  Image="{Binding Image}"
                                                                  RecipeContent="{Binding RecipeContent}"
                                                                  Products="{Binding Products}"
                                                                  ContentVisible="{Binding ContentVisible}"
                                                                  DeleteCommand="{Binding DeleteCommand}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </CollectionView.ItemTemplate>
                                    </CollectionView>
                                    <Label Text="You have no liked recipes." TextColor="#afafaf" HorizontalOptions="Center" VerticalOptions="Center" FontSize="15" IsVisible="{Binding NoLikedRecipes}"/>
                                </Grid>
                                <Grid Grid.Row="1"  IsVisible="{Binding SavedRecipesVisible}">
                                    <CollectionView Grid.Row="1" IsVisible="{Binding NoSavedRecipes,Converter={StaticResource InverseBooleanConverter}}"
                                                ItemsSource="{Binding SavedRecipes}"
                                                RemainingItemsThreshold="5"
                                                RemainingItemsThresholdReachedCommand="{Binding RecipesItemsThresholdExceedCommand}"
                                                RemainingItemsThresholdReachedCommandParameter="{x:Static viewmodel:RecipeType.Saved}"
                                                ItemsUpdatingScrollMode="KeepScrollOffset"
                                                WidthRequest="{Binding Source={x:Reference RecipeGrid},Path=Width}"
                                                Scrolled="CollectionView_Scrolled"
                                                HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource RecipeCollectionViewHeightAdjustValue}}">
                                        <CollectionView.ItemsLayout>
                                            <LinearItemsLayout Orientation="Vertical" ItemSpacing="5"/>
                                        </CollectionView.ItemsLayout>
                                        <CollectionView.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Padding="20,0,20,0">
                                                    <views:RecipeView Id="{Binding Id}"
                                                                  Username="{Binding Username}"
                                                                  Image="{Binding Image}"
                                                                  RecipeContent="{Binding RecipeContent}"
                                                                  Products="{Binding Products}"
                                                                  ContentVisible="{Binding ContentVisible}"
                                                                  DeleteCommand="{Binding DeleteCommand}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </CollectionView.ItemTemplate>
                                    </CollectionView>
                                    <Label Text="You have no saved recipes." TextColor="#afafaf" HorizontalOptions="Center" VerticalOptions="Center" FontSize="15" IsVisible="{Binding NoSavedRecipes}"/>
                                </Grid>
                            </Grid>
                        </Grid>

                    </ScrollView>

                    <Grid Grid.Column="1"
                      IsVisible="{Binding PostPageVisible}"
                      BackgroundColor="{DynamicResource MainBackgroundColor}"
                      WidthRequest="{Binding Source={x:Reference Page},Path=Width,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource MidBarWidthAdjustValue}}">
                        <VerticalStackLayout>
                            <Frame BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                               HeightRequest="60" 
                               Margin="15,5,0,0" 
                               BorderColor="Transparent" HorizontalOptions="Start" 
                               HasShadow="True" Padding="5">
                                <HorizontalStackLayout>
                                    <Frame Padding="0" 
                                       BackgroundColor="{DynamicResource MainBackgroundColor}">
                                        <Label Text="Add Post" TextColor="{DynamicResource TextColor}" 
                                           HorizontalOptions="Center" VerticalOptions="Center"/>
                                        <Frame.GestureRecognizers>
                                            <TapGestureRecognizer Command="{Binding ShowAddPostFormCommand}"/>
                                        </Frame.GestureRecognizers>
                                    </Frame>
                                </HorizontalStackLayout>
                            </Frame>
                            <CollectionView ItemsSource="{Binding Posts}"
                                        RemainingItemsThreshold="5"
                                        VerticalScrollBarVisibility="Always"
                                        ItemsUpdatingScrollMode="KeepScrollOffset"
                                        RemainingItemsThresholdReachedCommand="{Binding MainWallPostThresholdExceedCommand}"                                  
                                        HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource PostCollectionViewAdjustValue}}">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <views:PostView Username="{Binding Username}"
                                                        TimeStamp="{Binding TimeStamp}"
                                                        PostTextContent="{Binding PostTextContent}"
                                                        PostLikeCount="{Binding PostLikeCount}"
                                                        ImageSource="{Binding ImageSource}"
                                                        ImagesBase64="{Binding ImagesBase64}"
                                                        PfpImageBase64="{Binding PfpImageBase64}"
                                                        PostId="{Binding PostId}"
                                                        NewCommentContent="{Binding NewCommentContent}"
                                                        Payload="{Binding Payload}"
                                                        DeleteButtonVisible="{Binding DeleteButtonVisible}"
                                                        PostProducts="{Binding PostProducts}"
                                                        PostContentVisible="{Binding PostContentVisible}"
                                                        PostImagesVisible="{Binding PostImagesVisible}"
                                                        LikePostCommand="{Binding LikePostCommand}"
                                                        UnlikePostCommand="{Binding UnlikePostCommand}"
                                                        SaveRecipeCommand="{Binding SaveRecipeCommand}"
                                                        UnsaveRecipeCommand="{Binding UnsaveRecipeCommand}"
                                                        LikingCommand="{Binding LikingCommand}"
                                                        SavingCommand="{Binding SavingCommand}"
                                                        LikeText="{Binding LikeText}"
                                                        SavingText="{Binding SavingText}"
                                                        SaveIconPathFill="{Binding SaveIconPathFill}"
                                                        IsLiked="{Binding IsLiked}"
                                                        IsSaved="{Binding IsSaved}"/>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>



                        </VerticalStackLayout>
                        <Grid VerticalOptions="End" 
                          ZIndex="100"
                          HorizontalOptions="Center" BackgroundColor="Transparent" HeightRequest="100" WidthRequest="500"
                          IsVisible="{Binding WallPostLoadingActivityIndicatorVisible}">
                            <ActivityIndicator IsRunning="True"  Color="{DynamicResource TextColor}"/>
                        </Grid>
                    </Grid>

                    <ScrollView BackgroundColor="{DynamicResource SideBackgroundColor}" 
                            HorizontalOptions="End" 
                            VerticalOptions="Start" 
                            VerticalScrollBarVisibility="Always" 
                            WidthRequest="300"
                            HeightRequest="{Binding Source={x:Reference Page},Path=Height,Converter={StaticResource AdjustPostSpace},ConverterParameter={StaticResource RightBarHeightAdjustValue}}" 
                            Grid.Column="2">
                        <!--friends-->
                        <Grid>
                            <VerticalStackLayout Padding="10" Spacing="5" x:Name="OnlineFriendList" 
                                             BindableLayout.ItemsSource="{Binding OnlineFriends}"
                                             IsVisible="{Binding NoOnlineFriendsVisible,Converter={StaticResource InverseBooleanConverter}}">
                                <BindableLayout.ItemTemplate>
                                    <DataTemplate>
                                        <views:OnlineFreidnListElementView Username="{Binding Username}"
                                                                       UserId="{Binding UserId}"
                                                                       AvatarImageSource="{Binding AvatarImageSource}"
                                                                       IsOnline="{Binding IsOnline}"/>
                                    </DataTemplate>
                                </BindableLayout.ItemTemplate>
                            </VerticalStackLayout>
                            <Grid HorizontalOptions="Center" VerticalOptions="Center" IsVisible="{Binding NoOnlineFriendsVisible}">
                                <VerticalStackLayout > 
                                    <Path Data="M 24.15 21.624 c 2.716 -1.706 4.484 -5.014 4.484 -8.074 c 0 -4.362 -3.59 -9.236 -8.396 -9.236 S 11.842 9.188 11.842 13.55 c 0 3.06 1.768 6.37 4.484 8.074 c -6.444 1.73 -11.2 7.614 -11.2 14.596 c 0 0.46 0.378 0.84 0.84 0.84 h 28.546 c 0.46 0 0.84 -0.378 0.84 -0.84 C 35.352 29.238 30.594 23.354 24.15 21.624 M 6.83 35.38 z"
                                          Fill="#afafaf" HorizontalOptions="Center" HeightRequest="200"/>
                                    <Label Text="No Friends yet" TextColor="#afafaf" FontSize="15"/>
                                </VerticalStackLayout>
                            </Grid>
                        </Grid>
                </ScrollView>
                </Grid>
            </Grid>
        
        <Grid BackgroundColor="Transparent" VerticalOptions="Start" Margin="0,69,0,0" HorizontalOptions="Center" IsVisible="{Binding SearchPanelVisible}">
            <Grid>
                <Path Data="M 220 0 L 150 25 H 50 C 0 24.997 -0.001 24.997 0 75 V 450 C 0.011 499.992 0.011 500.023 50 500 H 750 C 799.999 499.991 799.999 499.991 800 450 V 75 C 799.965 25.995 799.965 25.995 750.468 25.956 L 650 25 L 590 0 H 220"
                      Fill="{DynamicResource MainBackgroundColorContrast}">
                </Path>
            </Grid>
            <Grid>
                <ScrollView HeightRequest="450" WidthRequest="780" BackgroundColor="Transparent" Margin="0,20,0,0">
                    <VerticalStackLayout Spacing="20" Padding="30" BindableLayout.ItemsSource="{Binding SearchResults}">
                        <BindableLayout.ItemTemplate>
                            <DataTemplate>
                                <views:UserSearchResultView Username="{Binding Username}"
                                                            Follows="{Binding Follows}"
                                                            Friends="{Binding Friends}"
                                                            PfpImageBase64="{Binding PfpImageBase64}"/>
                            </DataTemplate>
                        </BindableLayout.ItemTemplate>


                    </VerticalStackLayout>
                </ScrollView>
            </Grid>


            <Grid.Shadow>
                <Shadow Opacity="0.6 "
                        Brush="Black"/>
            </Grid.Shadow>
        </Grid>
        <Grid VerticalOptions="Start" 
              HorizontalOptions="Start" 
              Margin="46,72,0,0" 
              IsVisible="{Binding HubPanelVisible}"
              >
            <Grid BackgroundColor="Transparent" 
                  HeightRequest="301" 
                  WidthRequest="151">
                <Path Fill="{DynamicResource MainBackgroundColorContrast}" Data="M 75 0 L 60 25 H 25 C -3 25 0 22 0 49.772 V 275 C 0 303 -3 300 25 300 H 125 C 153 300 150 303 150 275 V 50 C 150 21 153 25 125 25 H 90 L 75 0"/>
            </Grid>
            <Grid BackgroundColor="Transparent" 
                  Margin="0,25,0,0" 
                  WidthRequest="145" 
                  HeightRequest="250">
                <VerticalStackLayout>
                    <Button CornerRadius="5" 
                            TextColor="{DynamicResource TextColor}" 
                            Text="Main" 
                            FontSize="20" 
                            FontAttributes="Bold" 
                            HeightRequest="50" 
                            BackgroundColor="{DynamicResource HubPanelBackground}" 
                            Command="{Binding ToMainViewCommand}"
                            >
                        <Button.GestureRecognizers>
                            <PointerGestureRecognizer PointerEntered="PointerGestureRecognizer_PointerEntered" PointerExited="PointerGestureRecognizer_PointerExited"/>
                        </Button.GestureRecognizers>
                        <!--<Button.Shadow>
                            <Shadow Opacity="0"
                Radius="50"/>
                        </Button.Shadow>-->
                    </Button>



                    <Button CornerRadius="5" TextColor="{DynamicResource TextColor}" Text="Profile" FontSize="20" FontAttributes="Bold" HeightRequest="50" BackgroundColor="{DynamicResource HubPanelBackground}" Command="{Binding ToProfileViewCommand}">
                        <Button.GestureRecognizers>
                            <PointerGestureRecognizer PointerEntered="PointerGestureRecognizer_PointerEntered" PointerExited="PointerGestureRecognizer_PointerExited"/>
                        </Button.GestureRecognizers>
                        <!--<Button.Shadow>
                            <Shadow Opacity="0"
                Radius="50"/>
                        </Button.Shadow>-->
                    </Button>



                    <Button CornerRadius="5" TextColor="{DynamicResource TextColor}" Text="Recipes"  FontSize="20" FontAttributes="Bold" HeightRequest="50" BackgroundColor="{DynamicResource HubPanelBackground}" Command="{Binding ToRecipesViewCommand}">
                        <Button.GestureRecognizers>
                            <PointerGestureRecognizer PointerEntered="PointerGestureRecognizer_PointerEntered" PointerExited="PointerGestureRecognizer_PointerExited"/>
                        </Button.GestureRecognizers>
                        <!--<Button.Shadow>
                            <Shadow Opacity="0"
                Radius="50"/>
                        </Button.Shadow>-->
                    </Button>





                    <Button CornerRadius="5" TextColor="{DynamicResource TextColor}" Text="Settings" FontSize="20" FontAttributes="Bold" HeightRequest="50" BackgroundColor="{DynamicResource HubPanelBackground}" Command="{Binding ToSettingViewCommand}">
                        <Button.GestureRecognizers>
                            <PointerGestureRecognizer PointerEntered="PointerGestureRecognizer_PointerEntered" 
                                                      PointerExited="PointerGestureRecognizer_PointerExited"/>
                        </Button.GestureRecognizers>
                        <!--<Button.Shadow>
                            <Shadow Opacity="0"
                                    Radius="50"/>
                        </Button.Shadow>--> 
                    </Button>

                    <Button CornerRadius="5" TextColor="{DynamicResource TextColor}" Text="Logout" FontSize="20" FontAttributes="Bold" HeightRequest="50" BackgroundColor="{DynamicResource HubPanelBackground}" Command="{Binding LogoutCommand}">
                        <Button.GestureRecognizers>
                            <PointerGestureRecognizer PointerEntered="PointerGestureRecognizer_PointerEntered" 
                                  PointerExited="PointerGestureRecognizer_PointerExited"/>
                        </Button.GestureRecognizers>
                    </Button>
                    
                </VerticalStackLayout>
            </Grid>
            <Grid.Shadow>
                <Shadow Opacity="0.6 "
                        Brush="Black"/>
            </Grid.Shadow>
            <Grid.GestureRecognizers>
                <PointerGestureRecognizer PointerExitedCommand="{Binding HideHubPanelCommand}"/>
            </Grid.GestureRecognizers>
        </Grid>
        
        <Grid BackgroundColor="Transparent"
              HeightRequest="140" 
              WidthRequest="250" 
              HorizontalOptions="End"                          
              VerticalOptions="Start"                         
              Margin="0,-200,100,0">
            <popup:FailedActionNotificationPopup />
        </Grid>

        <!--<Grid BackgroundColor="Transparent" IsVisible="{Binding InternetAcces}">
            <Grid BackgroundColor="Black" Opacity="0.4">

            </Grid>
            <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                <Label Text="No interntet connection" TextColor="{DynamicResource TextColor}"/>
                <ActivityIndicator IsRunning="True"  Color="{DynamicResource TextColor}"/>
            </VerticalStackLayout>
        </Grid>-->

        <!--<Grid IsVisible="{Binding AddPostFormVisible}">
            <Grid BackgroundColor="Black" Opacity="0.5">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding HideAddPostFormCommand}"/>
                </Grid.GestureRecognizers>
            </Grid>
            <Frame HeightRequest="475" WidthRequest="700" BackgroundColor="{DynamicResource MainBackgroundColor}">
                <Grid>
                    <VerticalStackLayout Spacing="10" IsVisible="{Binding PostContentEditorVisible}">
                        <Border Stroke="{Binding EditorBorderColor}" StrokeShape="RoundRectangle 10">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}">
                                <Editor Text="{Binding PostContent,Mode=TwoWay}" 
                                        TextColor="{DynamicResource TextColor}" 
                                        HeightRequest="300" 
                                        Placeholder="Share your recipe here..." />
                            </Grid>
                        </Border>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Button Text="Upload Images" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                    Grid.Column="0"
                                    Command="{Binding UploadPostImagesCommand}"
                                    Margin="5,0,5,0"/>
                            <Button Text="Choose Tags" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="1"
                                    Command="{Binding ChooseTagsCommand}"
                                    Margin="5,0,5,0"/>
                            <Button Text="Choose Products" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="2"
                                    Command="{Binding LoadProductsCommand}"
                                    Margin="5,0,5,0"/>
                            <Button Text="Post" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="3"
                                    Command="{Binding AddPostCommand}"
                                    Margin="5,0,5,0"/>
                        </Grid>
                        <HorizontalStackLayout BindableLayout.ItemsSource="{Binding AddPostImages}" 
                                               BackgroundColor="Transparent" 
                                               WidthRequest="650" 
                                               HeightRequest="60"
                                               VerticalOptions="Center">
                            <BindableLayout.ItemTemplate>
                                <DataTemplate>
                                    <views:PostImageView ImageSource="{Binding ImageSource}"/>
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </HorizontalStackLayout>
                        
                    </VerticalStackLayout>

                    <VerticalStackLayout IsVisible="{Binding TagPickerVisible}" Spacing="10">
                        <Border BackgroundColor="Gray" StrokeShape="RoundRectangle 40">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}" HeightRequest="40">
                                <Entry BackgroundColor="Transparent" TextColor="{DynamicResource TextColor}" Placeholder="Filter" Text="{Binding FilterParam,Mode=TwoWay}">
                                    <Entry.Behaviors>
                                        <toolkit:EventToCommandBehavior EventName="TextChanged" Command="{Binding FilterTagsCommand}"/>
                                    </Entry.Behaviors>
                                </Entry>
                            </Grid>
                        </Border>
                        <Border BackgroundColor="Gray" StrokeShape="RoundRectangle 10">
                            <ScrollView HeightRequest="200" VerticalScrollBarVisibility="Always" HorizontalScrollBarVisibility="Always">
                                <Grid>
                                    <toolkit:UniformItemsLayout BindableLayout.ItemsSource="{Binding Tags}"
                                                            MaxColumns="6" 
                                                            BackgroundColor="{DynamicResource EntryBackround}" 
                                                            Padding="15">
                                        <BindableLayout.ItemTemplate>
                                            <DataTemplate>
                                                <views:TagView Id="{Binding Id}" Name="{Binding Name}" FrameBackground="{Binding FrameBackground}"/>
                                            </DataTemplate>
                                        </BindableLayout.ItemTemplate>
                                    </toolkit:UniformItemsLayout>
                                    <ActivityIndicator IsRunning="True" IsVisible="{Binding TagsActivityIndicatorVisible}"  Color="{DynamicResource TextColor}"/>
                                </Grid>
                            </ScrollView>
                        </Border>
                        <Button TextColor="{DynamicResource TextColor}" BackgroundColor="{DynamicResource MainBackgroundColorContrast}" Command="{Binding ApplyTagsCommand}" Text="Save"></Button>
                    </VerticalStackLayout>

                    <VerticalStackLayout IsVisible="{Binding ProductPickerVisible}" 
                                         Spacing="10">
                        <Border BackgroundColor="Gray" 
                                StrokeShape="RoundRectangle 40">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}" 
                                  HeightRequest="40">
                                <Entry BackgroundColor="Transparent" 
                                       TextColor="{DynamicResource TextColor}" 
                                       Placeholder="Filter" 
                                       Text="{Binding FilterParam,Mode=TwoWay}">
                                    <Entry.Behaviors>
                                        <toolkit:EventToCommandBehavior EventName="TextChanged" 
                                                                        Command="{Binding FilterProductsCommand}"/>
                                    </Entry.Behaviors>
                                </Entry>
                            </Grid>
                        </Border>
                        <Border BackgroundColor="Gray" 
                                StrokeShape="RoundRectangle 10">
                            <ScrollView HeightRequest="200" 
                                        VerticalScrollBarVisibility="Always" 
                                        HorizontalScrollBarVisibility="Always"
                                        x:Name="MyScrollView">
                                <Grid>
                                    <toolkit:UniformItemsLayout BindableLayout.ItemsSource="{Binding Products}"
                                        MaxColumns="6" 
                                        BackgroundColor="{DynamicResource EntryBackround}" 
                                        Padding="15"
                                        >
                                        <BindableLayout.ItemTemplate>
                                            <DataTemplate>
                                                <views:ProductView Id="{Binding Id}" 
                                                               Name="{Binding Name}" 
                                                               FrameBackground="{Binding FrameBackground}"/>
                                            </DataTemplate>
                                        </BindableLayout.ItemTemplate>
                                    </toolkit:UniformItemsLayout>
                                    <ActivityIndicator IsRunning="True" IsVisible="{Binding ProductsActivityIndicatorVisible}"/>
                                </Grid>
                                <ScrollView.Behaviors>
                                    <toolkit:EventToCommandBehavior EventName="Scrolled" 
                                                                    Command="{Binding ProductsScrollCommand}"
                                                                    CommandParameter="{Binding Source={x:Reference MyScrollView}}"/>
                                </ScrollView.Behaviors>
                            </ScrollView>
                        </Border>
                        <Button TextColor="{DynamicResource TextColor}" 
                                BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                Command="{Binding ApplyProductsCommand}" Text="Save"/>
                    </VerticalStackLayout>

                    <Grid IsVisible="{Binding AddPostFormActivityIndicatorVisible}">
                        <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center">
                            <ActivityIndicator IsRunning="True"  Color="{DynamicResource TextColor}"/>
                            <Label Text="This might take a while..." TextColor="{DynamicResource TextColor}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Grid>
            </Frame>
            <Border IsVisible="{Binding PostModelvalidationFailedNotifierVisible}" HeightRequest="475" WidthRequest="700" StrokeThickness="0" StrokeShape="RoundRectangle 10">
                <Grid BackgroundColor="#050505" Opacity="0.6" HeightRequest="475" WidthRequest="700">
                    <Label Text="{Binding ErrMsg}" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center" VerticalOptions="Center"/>
                </Grid>
            </Border>
        </Grid>-->
        <!--<Grid BackgroundColor="{DynamicResource MainBackgroundColor}" IsVisible="{Binding LoadingScreenVisible}">
            <ActivityIndicator HorizontalOptions="Center" VerticalOptions="Center" Color="{DynamicResource TextColor}" IsRunning="True" Scale="1.5"/>
        </Grid>-->
        
        <!--<Grid BackgroundColor="{DynamicResource MainBackgroundColor}" IsVisible="{Binding ErrorScreenVisible}">
            <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="10">
                <Image Source="internalservererroricon.png" HeightRequest="100" WidthRequest="200"/>
                <Label Text="Internal server error, try again later." TextColor="{DynamicResource TextColor}" FontSize="20"/>
            </VerticalStackLayout>
        </Grid>-->
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Command="{Binding HideHubPanelCommand}" />
        </Grid.GestureRecognizers>
    </Grid>
        <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" IsVisible="{Binding LoadingScreenVisible}">
            <ActivityIndicator HorizontalOptions="Center" VerticalOptions="Center" Color="{DynamicResource TextColor}" IsRunning="True" Scale="1.5"/>
        </Grid>

        <Grid BackgroundColor="Transparent" IsVisible="{Binding InternetAcces}">
            <Grid BackgroundColor="Black" Opacity="0.4">

            </Grid>
            <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                <Label Text="No interntet connection" FontSize="{OnPlatform Android=15}" TextColor="{DynamicResource TextColor}"/>
                <ActivityIndicator IsRunning="True"  Color="{DynamicResource TextColor}"/>
            </VerticalStackLayout>
        </Grid>

        <Grid BackgroundColor="{DynamicResource MainBackgroundColor}" IsVisible="{Binding ErrorScreenVisible}">
            <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="10">
                <Image Source="internalservererroricon.png" HeightRequest="100" WidthRequest="200"/>
                <Label Text="Internal server error, try again later." HorizontalOptions="Center" TextColor="{DynamicResource TextColor}" FontSize="20"/>
            </VerticalStackLayout>
        </Grid>
        
        <Grid IsVisible="{Binding AddPostFormVisible}">
            <Grid BackgroundColor="Black" Opacity="0.5">
                <Grid.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding HideAddPostFormCommand}"/>
                </Grid.GestureRecognizers>
            </Grid>
            <Frame HeightRequest="475" WidthRequest="{OnPlatform WinUI=700}" BackgroundColor="{DynamicResource MainBackgroundColor}">
                <Grid>
                    <VerticalStackLayout Spacing="10" IsVisible="{Binding PostContentEditorVisible}">
                        <Border Stroke="{Binding EditorBorderColor}" StrokeShape="RoundRectangle 10">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}">
                                <Editor Text="{Binding PostContent,Mode=TwoWay}" 
                                        TextColor="{DynamicResource TextColor}" 
                                        HeightRequest="300" 
                                        Placeholder="Share your recipe here..." />
                            </Grid>
                        </Border>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Button Text="Upload Images" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                    Grid.Column="0"
                                    Command="{Binding UploadPostImagesCommand}"
                                    Margin="5,0,5,0"
                                    FontSize="{OnPlatform Android=9}"/>
                            <Button Text="Choose Tags" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="1"
                                    Command="{Binding ChooseTagsCommand}"
                                    Margin="5,0,5,0"
                                    FontSize="{OnPlatform Android=9}"
                                    Padding="{OnPlatform Android=0}"/>
                            <Button Text="Choose Products" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="2"
                                    Command="{Binding LoadProductsCommand}"
                                    Margin="5,0,5,0"
                                    FontSize="{OnPlatform Android=9}"
                                    Padding="{OnPlatform Android=0}"/>
                            <Button Text="Post" 
                                    TextColor="{DynamicResource TextColor}" 
                                    BackgroundColor="{DynamicResource MainBackgroundColorContrast}"
                                    Grid.Column="3"
                                    Command="{Binding AddPostCommand}"
                                    Margin="5,0,5,0" 
                                    FontSize="{OnPlatform Android=9}"/>
                        </Grid>
                        <HorizontalStackLayout BindableLayout.ItemsSource="{Binding AddPostImages}" 
                                               BackgroundColor="Transparent" 
                                               WidthRequest="650" 
                                               HeightRequest="60"
                                               VerticalOptions="Center">
                            <BindableLayout.ItemTemplate>
                                <DataTemplate>
                                    <views:PostImageView ImageSource="{Binding ImageSource}"/>
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </HorizontalStackLayout>

                    </VerticalStackLayout>

                    <VerticalStackLayout IsVisible="{Binding TagPickerVisible}" Spacing="10">
                        <Border BackgroundColor="Gray" StrokeShape="RoundRectangle 40">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}" HeightRequest="40">
                                <Entry BackgroundColor="Transparent" TextColor="{DynamicResource TextColor}" Placeholder="Filter" Text="{Binding FilterParam,Mode=TwoWay}">
                                    <Entry.Behaviors>
                                        <toolkit:EventToCommandBehavior EventName="TextChanged" Command="{Binding FilterTagsCommand}"/>
                                    </Entry.Behaviors>
                                </Entry>
                            </Grid>
                        </Border>
                        <Border BackgroundColor="Gray" StrokeShape="RoundRectangle 10">
                            <ScrollView HeightRequest="200" VerticalScrollBarVisibility="Always" HorizontalScrollBarVisibility="Always">
                                <Grid>
                                    <toolkit:UniformItemsLayout BindableLayout.ItemsSource="{Binding Tags}"
                                                            MaxColumns="6" 
                                                            BackgroundColor="{DynamicResource EntryBackround}" 
                                                            Padding="15">
                                        <BindableLayout.ItemTemplate>
                                            <DataTemplate>
                                                <views:TagView Id="{Binding Id}" Name="{Binding Name}" FrameBackground="{Binding FrameBackground}"/>
                                            </DataTemplate>
                                        </BindableLayout.ItemTemplate>
                                    </toolkit:UniformItemsLayout>
                                    <ActivityIndicator IsRunning="True" IsVisible="{Binding TagsActivityIndicatorVisible}"  Color="{DynamicResource TextColor}"/>
                                </Grid>
                            </ScrollView>
                        </Border>
                        <Button TextColor="{DynamicResource TextColor}" BackgroundColor="{DynamicResource MainBackgroundColorContrast}" Command="{Binding ApplyTagsCommand}" Text="Save"></Button>
                    </VerticalStackLayout>

                    <VerticalStackLayout IsVisible="{Binding ProductPickerVisible}" 
                                         Spacing="10">
                        <Border BackgroundColor="Gray" 
                                StrokeShape="RoundRectangle 40">
                            <Grid BackgroundColor="{DynamicResource EntryBackround}" 
                                  HeightRequest="40">
                                <Entry BackgroundColor="Transparent" 
                                       TextColor="{DynamicResource TextColor}" 
                                       Placeholder="Filter" 
                                       Text="{Binding FilterParam,Mode=TwoWay}">
                                    <Entry.Behaviors>
                                        <toolkit:EventToCommandBehavior EventName="TextChanged" 
                                                                        Command="{Binding FilterProductsCommand}"/>
                                    </Entry.Behaviors>
                                </Entry>
                            </Grid>
                        </Border>
                        <Border BackgroundColor="Gray" 
                                StrokeShape="RoundRectangle 10">
                            <ScrollView HeightRequest="200" 
                                        VerticalScrollBarVisibility="Always" 
                                        HorizontalScrollBarVisibility="Always"
                                        x:Name="MyScrollView">
                                <Grid>
                                    <toolkit:UniformItemsLayout BindableLayout.ItemsSource="{Binding Products}"
                                        MaxColumns="6" 
                                        BackgroundColor="{DynamicResource EntryBackround}" 
                                        Padding="15"
                                        >
                                        <BindableLayout.ItemTemplate>
                                            <DataTemplate>
                                                <views:ProductView Id="{Binding Id}" 
                                                               Name="{Binding Name}" 
                                                               FrameBackground="{Binding FrameBackground}"/>
                                            </DataTemplate>
                                        </BindableLayout.ItemTemplate>
                                    </toolkit:UniformItemsLayout>
                                    <ActivityIndicator IsRunning="True" IsVisible="{Binding ProductsActivityIndicatorVisible}"/>
                                </Grid>
                                <ScrollView.Behaviors>
                                    <toolkit:EventToCommandBehavior EventName="Scrolled" 
                                                                    Command="{Binding ProductsScrollCommand}"
                                                                    CommandParameter="{Binding Source={x:Reference MyScrollView}}"/>
                                </ScrollView.Behaviors>
                            </ScrollView>
                        </Border>
                        <Button TextColor="{DynamicResource TextColor}" 
                                BackgroundColor="{DynamicResource MainBackgroundColorContrast}" 
                                Command="{Binding ApplyProductsCommand}" Text="Save"/>
                    </VerticalStackLayout>

                    <Grid IsVisible="{Binding AddPostFormActivityIndicatorVisible}">
                        <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center">
                            <ActivityIndicator IsRunning="True"  Color="{DynamicResource TextColor}"/>
                            <Label Text="This might take a while..." TextColor="{DynamicResource TextColor}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Grid>
            </Frame>
            <Border IsVisible="{Binding PostModelvalidationFailedNotifierVisible}" HeightRequest="475" WidthRequest="700" StrokeThickness="0" StrokeShape="RoundRectangle 10">
                <Grid BackgroundColor="#050505" Opacity="0.6" HeightRequest="475" WidthRequest="700">
                    <Label Text="{Binding ErrMsg}" TextColor="{DynamicResource TextColor}" HorizontalOptions="Center" VerticalOptions="Center"/>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</ContentPage>
