<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Foodiefeed.BoardPage"
             Background="White"
             x:Name="Page"
             xmlns:local="clr-namespace:Foodiefeed;assembly=Foodiefeed"
             xmlns:viewmodel="clr-namespace:Foodiefeed.viewmodels"
             x:DataType="viewmodel:BoardViewModel">

    <ContentPage.Resources>
        <local:AdjustPostSpace x:Key="AdjustPostSpace"/>
        <local:FollowOrNotFollowConverter x:Key="FollowOrNotFollowConverter"/>
    </ContentPage.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="100"/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!--<BoxView Color="White" 
                 WidthRequest="250" 
                 HorizontalOptions="Start" 
                 HeightRequest="{Binding Path=Height}">
            <BoxView.Shadow>
                <Shadow Offset="3,5"
                        Opacity="0.8"/>
            </BoxView.Shadow>   
        </BoxView>-->

        <Grid Grid.Row="0">
                   <BoxView Color="White" 
                      WidthRequest="{Binding Source={x:Reference Page},Path=Width}" 
                      HeightRequest="100" 
                      VerticalOptions="Start">
                   <BoxView.Shadow>
                        <Shadow Opacity="0.8"/>
                   </BoxView.Shadow>
              </BoxView>

            <Border Margin="0,20,0,0" 
                    VerticalOptions="Start" 
                    Stroke="Gray" 
                    StrokeThickness="1.5" 
                    StrokeShape="RoundRectangle 20,20,20,20" 
                    HeightRequest="50" 
                    WidthRequest="420">

                <Entry TextColor="Black" 
                       FontSize="18" 
                       Placeholder="Search" 
                       Margin="0" 
                       HeightRequest="40" 
                       WidthRequest="400" 
                       Background="White"/>
            </Border>

            <ImageButton Source="logobutton.png" 
                HeightRequest="50" 
                WidthRequest="50" 
                VerticalOptions="Start" 
                HorizontalOptions="Start" 
                Margin="20"/>
        </Grid>

        <Grid Grid.Row="1">   <!--left for some pages buttons or custom flyout | middle for posts | left for friends-->

            <ScrollView   Grid.Column="0"> <!--pages-->
                <Grid BackgroundColor="Red"  WidthRequest="300" HorizontalOptions="Start">
                    
                </Grid>
            </ScrollView>
            
            <!--posts-->
                <!--<VerticalStackLayout BackgroundColor="Green" 
                      WidthRequest="{Binding Source={x:Reference Page},Path=Width,Converter={StaticResource AdjustPostSpace}}"
                      HorizontalOptions="Center"
                      Padding="10">
                        <local:BoardPost/>
                        <local:BoardPost/>
                        <local:BoardPost/>
                        <local:BoardPost/>
                        <local:BoardPost/>
                        <local:BoardPost/>
                    
                    </VerticalStackLayout>-->

            
                <CollectionView Grid.Column="1" 
                          HorizontalScrollBarVisibility="Always"
                          BackgroundColor="Green"
                          WidthRequest="{Binding Source={x:Reference Page},Path=Width,Converter={StaticResource AdjustPostSpace}}"
                          HorizontalOptions="Center"
                          ItemsSource="{Binding Posts}"
                          VerticalOptions="FillAndExpand">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="local:Post" >
                            
                            <!-- https://github.com/dotnet/maui/issues/11369 -->
                                <Grid WidthRequest="600" BackgroundColor="White">
                                    <Grid.RowDefinitions>
                                        <RowDefinition/> <!--0 username follow | 3 dots to go to profile-->
                                        <RowDefinition/> <!--1 post text content-->
                                        <RowDefinition/> <!--2 images-->
                                        <RowDefinition/> <!--3 like comments share-->
                                        <RowDefinition/> <!--4 comment section-->
                                    </Grid.RowDefinitions>
                                <Grid Padding="20" Grid.Row="0">
                                    <HorizontalStackLayout Spacing="10">
                                    <VerticalStackLayout>
                                        <Label TextColor="Black" FontSize="15" FontAttributes="Bold" Text="{Binding PosterUsername}"/>
                                        <Label TextColor="Black" FontSize="10" Text="10 hours ago"/>
                                    </VerticalStackLayout>
                                        <Label TextColor="Black" FontSize="15" FontAttributes="Bold" Text="•"/>
                                        <Label TextColor="Black" FontSize="15" FontAttributes="Bold" Text="{Binding isFollowed, Converter={StaticResource FollowOrNotFollowConverter}}"/>
                                    </HorizontalStackLayout>
                                    <ImageButton HorizontalOptions="End" HeightRequest="10"  Source="threedotmenu.png" />
                                </Grid>
                                <Grid Padding="20" Grid.Row="1" >
                                     <Label TextColor="Black" Text="{Binding PostTextContent}" LineBreakMode="WordWrap"/>
                                </Grid>
                                    
                                <Grid Grid.Row="2">
                                    <Image 
                                </Grid>
                            





                            <Grid Grid.Row="4"> <!--comment section grid -->
                                        
                                    </Grid>
                              </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>



            <ScrollView Grid.Column="2"> <!--friends-->
                <Grid HorizontalOptions="End" WidthRequest="300" BackgroundColor="Blue">

                </Grid>
            </ScrollView>


        </Grid>




    </Grid>

</ContentPage>
